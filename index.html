<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="theme-color" content="#020617">
    <title>Vibe OS: THE ARCHITECT - SUPREME MONOLITH</title>
    
    <script src="https://unpkg.com/html5-qrcode" type="text/javascript"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Rubik:wght@300;400;500;700;900&display=swap" rel="stylesheet">

    <style>
        /* ==========================================================================
           SECTION 1: SUPREME DESIGN TOKENS & ATOMIC CSS
           ========================================================================== */
        :root {
            /* --- BACKGROUND ARCHITECTURE --- */
            --bg-void: #000000;
            --bg-deep: #020617;
            --bg-glass-morphism: rgba(15, 23, 42, 0.88);
            --bg-card-monolith: rgba(30, 41, 59, 0.75);
            
            /* --- THE BORDER GLOW MATRIX --- */
            --border-standard: rgba(255, 255, 255, 0.12);
            --border-active-glow: rgba(99, 102, 241, 0.6);
            --border-ap-neon: rgba(57, 255, 20, 0.5);
            
            /* --- PLASMA NEON SPECTRUM --- */
            --plasma-indigo: #4f46e5;
            --plasma-cyan: #06b6d4;
            --plasma-violet: #8b5cf6;
            --gradient-titan-prime: linear-gradient(135deg, var(--plasma-indigo), var(--plasma-cyan));
            --gradient-nebula-live: radial-gradient(circle at center, var(--plasma-indigo) 0%, transparent 80%);

            /* --- THE ARCHITECT GRADING SYSTEM (7 TIERS) --- */
            --g-ap: #39ff14; /* A+ Neon Radiant Green */
            --g-a: #22c55e;  /* Pure Organic Green */
            --g-bp: #ccff00; /* Neon Lime (B+) */
            --g-b: #a3e635;  /* Yellow-Green Transition */
            --g-c: #facc15;  /* Warning Yellow (High Contrast) */
            --g-d: #fb923c;  /* Alert Orange (High Visibility) */
            --g-e: #ff0000;  /* Critical Red (Absolute Veto) */

            /* --- CATEGORY LOGIC IDENTIFIERS --- */
            --color-medical: #f43f5e;
            --color-dietary: #3b82f6;
            --color-kosher: #eab308;
            --color-ethics: #10b981;
            --color-sensory: #ff66cc;
            --color-avoidance: #a855f7;

            /* --- LAYOUT ARCHITECTURE --- */
            --app-max-width: 480px;
            --app-radius-xl: 52px;
            --font-main: 'Rubik', sans-serif;
            --safe-area-bottom: 165px;
            --transition-titan: 0.6s cubic-bezier(0.16, 1, 0.3, 1);
            --shadow-monolith: 0 50px 150px rgba(0,0,0,1);
        }

        /* ==========================================================================
           SECTION 2: GLOBAL RESET & NEBULA 6.0 LIVE ENGINE
           ========================================================================== */
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            -webkit-tap-highlight-color: transparent;
            outline: none;
            user-select: none;
        }

        html, body {
            height: 100vh;
            width: 100vw;
            background-color: #000;
            color: #f8fafc;
            font-family: var(--font-main);
            overflow: hidden;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        /* LIVE QUANTUM NEBULA ENGINE (SINGLETON) */
        .nebula-monolith {
            position: fixed;
            top: 0; left: 0;
            width: 100%; height: 100%;
            z-index: -1;
            background: var(--bg-deep);
            overflow: hidden;
            pointer-events: none;
        }
        
        .nebula-monolith::after {
            content: '';
            position: absolute;
            inset: 0;
            background: url('https://grainy-gradients.vercel.app/noise.svg');
            opacity: 0.2;
            mix-blend-mode: overlay;
        }

        .orb-quantum {
            position: absolute;
            border-radius: 50%;
            filter: blur(130px);
            opacity: 0.45;
            animation: orbTitanMotion 30s infinite alternate ease-in-out;
        }

        .orb-primary { width: 800px; height: 800px; background: var(--plasma-indigo); top: -25%; left: -25%; }
        .orb-secondary { width: 700px; height: 700px; background: var(--plasma-cyan); bottom: -20%; right: -20%; animation-delay: -8s; }
        .orb-tertiary { width: 450px; height: 450px; background: var(--plasma-violet); top: 35%; left: 35%; opacity: 0.2; animation-delay: -15s; }

        @keyframes orbTitanMotion {
            0% { transform: translate(0, 0) scale(1) rotate(0deg); opacity: 0.25; }
            50% { transform: translate(120px, 60px) scale(1.15) rotate(120deg); opacity: 0.5; }
            100% { transform: translate(-60px, 120px) scale(1) rotate(240deg); opacity: 0.25; }
        }

        /* ==========================================================================
           SECTION 3: BOOT SEQUENCE SYSTEM
           ========================================================================== */
        #master-boot-screen {
            position: fixed;
            inset: 0;
            background: var(--bg-void);
            z-index: 9999;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            transition: opacity 1.5s var(--transition-titan);
        }

        .boot-branding {
            position: relative;
            margin-bottom: 60px;
        }

        .boot-logo-glitch {
            font-size: 72px;
            font-weight: 950;
            letter-spacing: 12px;
            background: var(--gradient-titan-prime);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            animation: titanPulse 2.8s infinite cubic-bezier(0.4, 0, 0.2, 1);
        }

        .boot-track {
            width: 280px;
            height: 3px;
            background: rgba(255,255,255,0.06);
            border-radius: 30px;
            overflow: hidden;
            position: relative;
            box-shadow: 0 0 10px rgba(0,0,0,0.5);
        }

        .boot-track-fill {
            height: 100%;
            width: 0%;
            background: var(--plasma-cyan);
            box-shadow: 0 0 35px var(--plasma-cyan);
            animation: bootDeployment 3.5s forwards cubic-bezier(0.22, 1, 0.36, 1);
        }

        .boot-log-txt {
            margin-top: 30px;
            font-size: 12px;
            color: #64748b;
            text-transform: uppercase;
            letter-spacing: 5px;
            font-weight: 800;
        }

        @keyframes bootDeployment { 0% { width: 0%; } 100% { width: 100%; } }
        @keyframes titanPulse { 0%,100% { filter: blur(0) brightness(1); transform: scale(1); } 50% { filter: blur(6px) brightness(1.6); opacity: 0.55; transform: scale(0.98); } }

        /* ==========================================================================
           SECTION 4: SUPREME VIEWPORT ARCHITECTURE
           ========================================================================== */
        #master-app-viewport {
            width: 100%;
            max-width: var(--app-max-width);
            height: 100%;
            max-height: 96vh;
            background: rgba(15, 23, 42, 0.82);
            backdrop-filter: blur(65px);
            -webkit-backdrop-filter: blur(65px);
            border: 1px solid var(--border-subtle);
            border-radius: var(--app-radius-xl);
            box-shadow: 0 0 0 15px #000, var(--shadow-monolith);
            display: flex;
            flex-direction: column;
            position: relative;
            overflow: hidden;
            opacity: 0;
            transform: translateY(50px) scale(0.97);
            transition: 1.4s var(--transition-titan);
        }

        #master-app-viewport.active {
            opacity: 1;
            transform: translateY(0) scale(1);
        }

        @media (max-width: 480px) {
            #master-app-viewport {
                max-width: 100%;
                height: 100vh;
                max-height: 100vh;
                border-radius: 0;
                box-shadow: none;
                border: none;
            }
        }

        /* SCROLL ENGINE ARCHITECT */
        #master-scroll-container {
            flex: 1;
            overflow-y: auto;
            overflow-x: hidden;
            padding-bottom: var(--safe-area-bottom);
            scrollbar-width: none;
            scroll-behavior: smooth;
        }
        #master-scroll-container::-webkit-scrollbar { display: none; }

        /* ==========================================================================
           SECTION 5: MASTER HEADER & INTERFACE
           ========================================================================== */
        .app-master-header {
            padding: 36px 40px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: rgba(2, 6, 23, 0.9);
            border-bottom: 1px solid var(--border-subtle);
            position: sticky;
            top: 0;
            z-index: 100;
            backdrop-filter: blur(20px);
        }

        .master-brand-logo {
            font-size: 30px;
            font-weight: 1000;
            letter-spacing: 1.5px;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .master-brand-logo span {
            background: var(--gradient-titan-prime);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            font-style: italic;
        }

        .master-action-btn {
            width: 56px;
            height: 56px;
            border-radius: 20px;
            background: var(--bg-glass);
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            border: 1px solid rgba(255,255,255,0.05);
            transition: 0.4s var(--transition-titan);
            color: #fff;
            font-size: 24px;
            box-shadow: inset 0 0 15px rgba(255,255,255,0.04);
        }

        .master-action-btn:active {
            transform: scale(0.8) rotate(15deg);
            background: rgba(255,255,255,0.18);
            border-color: var(--plasma-cyan);
            box-shadow: 0 0 25px rgba(6, 182, 212, 0.4);
        }

        /* ==========================================================================
           SECTION 6: BI DASHBOARD ARCHITECTURE
           ========================================================================== */
        .bi-dashboard-grid {
            padding: 28px;
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 18px;
        }

        .bi-card-titan {
            background: var(--bg-card-monolith);
            border: 1px solid var(--border-subtle);
            border-radius: 40px;
            padding: 32px;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            min-height: 155px;
            cursor: pointer;
            transition: 0.5s var(--transition-titan);
            position: relative;
            overflow: hidden;
        }

        .bi-card-titan::after {
            content: '';
            position: absolute;
            inset: 0;
            background: linear-gradient(135deg, transparent, rgba(255,255,255,0.04));
            opacity: 0;
            transition: 0.5s;
        }

        .bi-card-titan:hover {
            border-color: var(--border-active-glow);
            transform: translateY(-6px) scale(1.02);
            box-shadow: 0 20px 40px rgba(0,0,0,0.5);
        }
        
        .bi-card-titan:hover::after { opacity: 1; }

        .bi-card-titan:active {
            transform: scale(0.96);
        }
        
        .bi-card-hero-titan {
            grid-column: 1 / -1;
            flex-direction: row;
            align-items: center;
            border-left: 10px solid var(--plasma-indigo);
            background: linear-gradient(160deg, #1e293b, #020617);
        }

        .bi-card-score-titan {
            grid-column: 1 / -1;
            min-height: 185px;
            border-right: 10px solid var(--g-ap);
            background: linear-gradient(160deg, #1e293b, #020617);
        }

        /* BI Typography */
        .bi-label-titan {
            font-size: 12px;
            font-weight: 1000;
            color: #94a3b8;
            text-transform: uppercase;
            letter-spacing: 4px;
            margin-bottom: 12px;
        }

        .bi-value-titan {
            font-size: 40px;
            font-weight: 1000;
            color: #fff;
            letter-spacing: -2.5px;
            line-height: 0.9;
        }

        .bi-sub-titan {
            font-size: 15px;
            color: var(--plasma-cyan);
            font-weight: 800;
            margin-top: 12px;
            letter-spacing: 1px;
        }

        /* THE ANALYTIC TITAN GAUGE 7.0 */
        .bi-gauge-system {
            width: 100%;
            height: 16px;
            background: rgba(0,0,0,0.8);
            border-radius: 8px;
            margin-top: 30px;
            overflow: hidden;
            position: relative;
            border: 1px solid rgba(255,255,255,0.1);
        }

        .bi-gauge-fill-monolith {
            height: 100%;
            width: 0%;
            background: linear-gradient(90deg, var(--g-e), var(--g-c), var(--g-a), var(--g-ap));
            transition: width 2.2s cubic-bezier(0.34, 1.56, 0.64, 1);
            box-shadow: 0 0 30px rgba(57, 255, 20, 0.3);
        }
        
        /* Dashboard Floating Badge */
        .score-orb-titan-floating {
            position: absolute;
            top: 28px;
            left: 28px;
            width: 84px;
            height: 84px;
            border-radius: 50%;
            border: 7px solid;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 36px;
            font-weight: 1000;
            transition: 1s var(--transition-titan);
            box-shadow: 0 0 60px rgba(0,0,0,0.9);
            background: rgba(0,0,0,0.5);
            z-index: 5;
        }

        /* TITAN SEARCH MATRIX UI */
        .lookup-matrix-container {
            padding: 15px 28px;
            display: flex;
            gap: 18px;
            margin-top: 15px;
        }

        .lookup-input-master {
            flex: 1;
            background: var(--bg-glass);
            border: 1px solid var(--border-subtle);
            padding: 26px;
            border-radius: 32px;
            color: #fff;
            text-align: right;
            font-size: 20px;
            transition: 0.5s var(--transition-titan);
            font-family: var(--font-main);
            font-weight: 600;
            box-shadow: inset 0 5px 15px rgba(0,0,0,0.4);
        }

        .lookup-input-master:focus {
            border-color: var(--plasma-cyan);
            background: #000;
            box-shadow: 0 0 40px rgba(6, 182, 212, 0.4);
            transform: scale(1.02);
        }

        .lookup-btn-master {
            width: 84px;
            background: var(--gradient-titan-prime);
            border: none;
            border-radius: 32px;
            font-size: 32px;
            color: #fff;
            cursor: pointer;
            box-shadow: 0 20px 50px rgba(99, 102, 241, 0.6);
            display: flex;
            align-items: center;
            justify-content: center;
            transition: 0.4s var(--transition-titan);
        }

        .lookup-btn-master:active {
            transform: scale(0.8) translateY(8px);
            box-shadow: 0 5px 15px rgba(99, 102, 241, 0.3);
        }

        .master-dashboard-tags {
            padding: 28px 36px;
            display: flex;
            flex-wrap: wrap;
            gap: 14px;
        }

        .titan-pills-master {
            font-size: 13px;
            padding: 12px 22px;
            background: rgba(255,255,255,0.08);
            border: 1px solid rgba(255,255,255,0.15);
            border-radius: 25px;
            color: #f1f5f9;
            font-weight: 800;
            display: flex;
            align-items: center;
            gap: 10px;
            transition: 0.4s;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }

        /* ==========================================================================
           7. SUPREME TITAN DOCK ARCHITECTURE
           ========================================================================== */
        .dock-titan-absolute-wrap {
            position: absolute;
            bottom: 45px;
            left: 0;
            width: 100%;
            display: flex;
            justify-content: center;
            z-index: 1000;
            pointer-events: none;
        }

        .dock-titan-monolith-bar {
            pointer-events: auto;
            width: 94%;
            max-width: 460px;
            height: 98px;
            background: rgba(15, 23, 42, 0.98);
            backdrop-filter: blur(45px);
            border-radius: 42px;
            border: 1px solid rgba(255,255,255,0.25);
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0 65px;
            box-shadow: 0 45px 120px rgba(0,0,0,1);
        }
        
        .dock-monolith-trigger {
            font-size: 34px;
            color: #64748b;
            cursor: pointer;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 8px;
            transition: 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }

        .dock-monolith-trigger span {
            font-size: 12px;
            font-weight: 1000;
            text-transform: uppercase;
            letter-spacing: 2px;
            opacity: 0.8;
        }

        .dock-monolith-trigger:active {
            color: #fff;
            transform: translateY(-15px) scale(1.2);
        }

        .dock-monolith-trigger.is-active {
            color: var(--plasma-cyan);
            opacity: 1;
            text-shadow: 0 0 25px var(--plasma-cyan);
        }

        /* SUPREME SCANNER FAB MONOLITH v7 */
        .scanner-monolith-fab-anchor {
            position: relative;
            margin-top: -75px;
        }

        .scanner-fab-core-monolith {
            width: 108px;
            height: 108px;
            border-radius: 40px;
            background: var(--gradient-titan-prime);
            border: 11px solid #020617;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            box-shadow: 0 30px 80px rgba(79, 70, 229, 0.7);
            cursor: pointer;
            transform: rotate(45deg) translateY(-45px);
            transition: 0.6s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }

        .scanner-fab-core-monolith:active {
            transform: rotate(45deg) translateY(-45px) scale(0.75);
            box-shadow: 0 15px 35px rgba(79, 70, 229, 0.4);
        }

        .scan-monolith-viz {
            transform: rotate(-45deg);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            gap: 6px;
        }

        .vector-barcode-supreme {
            display: flex;
            gap: 6px;
            height: 36px;
            align-items: center;
        }

        .vector-bar-segment {
            width: 6px;
            background: #fff;
            border-radius: 2px;
        }

        .vector-bar-segment:nth-child(1) { height: 24px; }
        .vector-bar-segment:nth-child(2) { height: 40px; width: 10px; }
        .vector-bar-segment:nth-child(3) { height: 20px; }
        .vector-bar-segment:nth-child(4) { height: 34px; width: 5px; }

        .scan-monolith-text {
            font-size: 13px;
            font-weight: 1000;
            color: #fff;
            letter-spacing: 4px;
            text-transform: uppercase;
            text-shadow: 0 0 20px rgba(0,0,0,0.6);
        }

        /* ==========================================================================
           8. MASTER MODAL ARCHITECTURE (PRO SHEETS)
           ========================================================================== */
        .monolith-modal-overlay {
            position: absolute;
            inset: 0;
            background: rgba(0,0,0,0.97);
            z-index: 2000;
            display: none;
            flex-direction: column;
            justify-content: flex-end;
            opacity: 0;
            transition: opacity 0.5s var(--transition-titan);
        }

        .monolith-modal-overlay.is-visible {
            display: flex;
            opacity: 1;
        }

        .monolith-master-sheet {
            width: 100%;
            height: 96%;
            background: #0f172a;
            border-top-left-radius: 64px;
            border-top-right-radius: 64px;
            border-top: 3px solid rgba(255,255,255,0.3);
            display: flex;
            flex-direction: column;
            transform: translateY(100%);
            transition: transform 0.7s cubic-bezier(0.19, 1, 0.22, 1);
            box-shadow: 0 -50px 200px rgba(0,0,0,1);
        }

        .monolith-modal-overlay.is-visible .monolith-master-sheet {
            transform: translateY(0);
        }

        .sheet-header-supreme {
            padding: 45px 50px;
            border-bottom: 1px solid rgba(255,255,255,0.1);
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: rgba(15, 23, 42, 0.5);
        }

        .sheet-title-supreme {
            font-size: 32px;
            font-weight: 1000;
            color: #fff;
            letter-spacing: -1.5px;
        }

        .sheet-close-supreme {
            width: 54px;
            height: 54px;
            border-radius: 50%;
            background: rgba(255,255,255,0.15);
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: 0.3s;
            font-size: 24px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
        }

        .sheet-close-supreme:active {
            transform: scale(0.75);
            background: rgba(255,255,255,0.3);
        }

        .sheet-scroll-monolith {
            padding: 40px 50px;
            overflow-y: auto;
            flex: 1;
            padding-bottom: 250px;
            scrollbar-width: none;
        }
        .sheet-scroll-monolith::-webkit-scrollbar { display: none; }

        .sheet-footer-monolith {
            padding: 40px 50px 70px 50px;
            background: #0f172a;
            border-top: 1px solid rgba(255,255,255,0.1);
            position: absolute;
            bottom: 0;
            width: 100%;
            z-index: 20;
        }

        /* ==========================================================================
           9. THE 75+ PARAMETER ACCORDION ENGINE
           ========================================================================== */
        .param-acc-monolith {
            background: rgba(255,255,255,0.05);
            border: 1px solid rgba(255,255,255,0.15);
            border-radius: 40px;
            margin-bottom: 24px;
            overflow: hidden;
            transition: 0.5s var(--transition-titan);
        }

        .param-acc-monolith.is-open {
            border-color: var(--plasma-indigo);
            box-shadow: 0 30px 70px rgba(0,0,0,0.6);
            transform: scale(1.02);
        }

        .param-acc-header {
            padding: 32px 36px;
            font-weight: 1000;
            display: flex;
            justify-content: space-between;
            align-items: center;
            cursor: pointer;
            font-size: 20px;
            letter-spacing: 0.5px;
        }

        .param-acc-body {
            display: none;
            padding: 40px;
            background: rgba(0,0,0,0.6);
            border-top: 1px solid rgba(255,255,255,0.1);
            gap: 20px;
            flex-wrap: wrap;
        }

        .param-acc-monolith.is-open .param-acc-body {
            display: flex;
        }

        .param-chip-titan-input { display: none; }
        
        .param-chip-titan-label {
            padding: 22px 32px;
            background: #1e293b;
            border-radius: 28px;
            font-size: 17px;
            color: #94a3b8;
            cursor: pointer;
            border: 3px solid transparent;
            transition: 0.4s var(--transition-titan);
            display: flex;
            align-items: center;
            gap: 16px;
            box-shadow: 0 10px 20px rgba(0,0,0,0.3);
        }

        .param-chip-titan-input:checked + .param-chip-titan-label {
            background: rgba(99, 102, 241, 0.35);
            border-color: var(--plasma-indigo);
            color: #fff;
            font-weight: 1000;
            transform: scale(1.1) translateY(-5px);
            box-shadow: 0 20px 45px rgba(0,0,0,0.7);
        }

        /* TITAN CATEGORY THEMES */
        .theme-med .param-acc-header { color: var(--g-e); border-right: 10px solid var(--g-e); }
        .theme-diet .param-acc-header { color: var(--plasma-cyan); border-right: 10px solid var(--plasma-cyan); }
        .theme-kosh .param-acc-header { color: var(--cat-kosh); border-right: 10px solid var(--cat-kosh); }
        .theme-ethic .param-acc-header { color: var(--cat-ethics); border-right: 10px solid var(--cat-ethics); }
        .theme-chem .param-acc-header { color: var(--color-avoidance); border-right: 10px solid var(--color-avoidance); }
        .theme-qual .param-acc-header { color: var(--g-ap); border-right: 10px solid var(--g-ap); }

        /* ==========================================================================
           10. QUANTUM PRO SCANNER MODULE (FHD)
           ========================================================================== */
        #master-quantum-scanner-viewport {
            position: absolute;
            inset: 0;
            background: #000;
            z-index: 3000;
            display: none;
            flex-direction: column;
        }

        #master-quantum-scanner-viewport.is-active {
            display: flex;
        }

        #qr-engine-monolith-instance {
            flex: 1;
            width: 100%;
            height: 100%;
            object-fit: cover;
            filter: contrast(1.25) brightness(1.1) saturate(1.2);
        }

        .quantum-hud-monolith {
            position: absolute;
            inset: 0;
            pointer-events: none;
            display: flex;
            justify-content: center;
            align-items: center;
            background: linear-gradient(rgba(0,0,0,0.8) 0%, transparent 30%, transparent 70%, rgba(0,0,0,0.8) 100%);
        }

        .quantum-frame-monolith {
            width: 380px;
            height: 380px;
            border: 5px solid rgba(255,255,255,0.3);
            border-radius: 90px;
            position: relative;
            box-shadow: 0 0 0 10000px rgba(0,0,0,0.95);
        }

        .quantum-frame-edge {
            position: absolute;
            inset: -12px;
            border: 10px solid var(--plasma-cyan);
            border-radius: 90px;
            clip-path: polygon(0 0, 25% 0, 25% 100%, 0 100%, 0 0, 100% 0, 100% 25%, 0 25%, 0 0, 100% 0, 100% 100%, 75% 100%, 75% 0, 100% 0, 100% 100%, 0 100%, 0 75%, 100% 75%, 100% 100%, 0 100%);
        }

        .quantum-scanner-laser {
            position: absolute;
            top: 50%;
            left: 12%;
            right: 12%;
            height: 5px;
            background: var(--g-e);
            box-shadow: 0 0 60px var(--g-e), 0 0 25px #fff;
            animation: quantumPulseSweep 2.5s infinite ease-in-out;
            border-radius: 50%;
        }

        @keyframes quantumPulseSweep {
            0%, 100% { top: 15%; opacity: 0.2; transform: scaleX(0.8); }
            50% { top: 85%; opacity: 1; transform: scaleX(1.1); }
        }

        /* ==========================================================================
           11. INTELLIGENCE OUTPUT (RESULTS)
           ========================================================================== */
        .grade-orb-supreme-monolith {
            width: 200px;
            height: 200px;
            border-radius: 50%;
            border: 20px solid;
            margin: 0 auto 50px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 96px;
            font-weight: 1000;
            box-shadow: 0 0 160px currentColor;
            color: #fff;
            text-shadow: 0 0 50px rgba(0,0,0,0.8);
            transition: 0.8s var(--transition-titan);
        }

        .intelligence-report-card {
            text-align: right;
            background: rgba(255,255,255,0.08);
            padding: 35px;
            border-radius: 48px;
            border-right: 15px solid var(--plasma-cyan);
            line-height: 2.4;
            font-size: 19px;
            box-shadow: inset 0 0 40px rgba(0,0,0,0.5);
            margin-bottom: 40px;
        }

        .intelligence-report-line {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 12px;
            font-weight: 700;
        }

        .intelligence-report-line i { font-size: 18px; }

        /* LISTING ARCHITECTURE (CART & VAULT) */
        .supreme-list-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 32px;
            border-bottom: 1px solid rgba(255,255,255,0.1);
            transition: 0.5s var(--transition-titan);
        }

        .supreme-list-row:hover {
            background: rgba(255,255,255,0.05);
            transform: translateX(-10px) scale(1.01);
        }

        .grade-badge-supreme {
            font-size: 20px;
            font-weight: 1000;
            padding: 14px 28px;
            border-radius: 18px;
            color: #000;
            min-width: 76px;
            text-align: center;
            box-shadow: 0 12px 25px rgba(0,0,0,0.6);
        }

        .row-master-details h4 { font-size: 22px; font-weight: 1000; margin-bottom: 6px; letter-spacing: -0.5px; }
        .row-master-details span { font-size: 16px; color: #64748b; font-weight: 700; }

        /* ==========================================================================
           12. THE SUPREME ACTION BUTTONS
           ========================================================================== */
        .btn-titan-architect {
            width: 100%;
            padding: 28px;
            border-radius: 32px;
            font-weight: 1000;
            font-size: 24px;
            border: none;
            cursor: pointer;
            transition: 0.5s var(--transition-titan);
            margin-top: 25px;
            position: relative;
            overflow: hidden;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 20px;
            letter-spacing: 2px;
            text-transform: uppercase;
        }

        .btn-titan-architect::before {
            content: '';
            position: absolute;
            top: 0; left: -100%;
            width: 100%; height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
            transition: 0.8s;
        }

        .btn-titan-architect:hover::before { left: 100%; }

        .btn-titan-architect:active {
            transform: scale(0.92) translateY(8px);
            filter: brightness(1.2);
        }

        .btn-architect-primary {
            background: var(--gradient-titan-prime);
            color: #fff;
            box-shadow: 0 25px 80px rgba(79, 70, 229, 0.6);
        }

        .btn-architect-secondary {
            background: rgba(255,255,255,0.1);
            border: 3px solid rgba(255,255,255,0.25);
            color: #fff;
            backdrop-filter: blur(10px);
        }

        /* SUPREME TOAST SYSTEM */
        #master-titan-toast {
            position: fixed;
            top: 80px;
            left: 50%;
            transform: translateX(-50%) translateY(-250px);
            background: #1e293b;
            color: #fff;
            padding: 26px 85px;
            border-radius: 120px;
            z-index: var(--z-toast);
            border: 3px solid var(--plasma-cyan);
            font-weight: 1000;
            transition: 0.9s cubic-bezier(0.68, -0.6, 0.32, 1.6);
            box-shadow: 0 50px 150px rgba(0,0,0,1);
            white-space: nowrap;
            letter-spacing: 4px;
            text-transform: uppercase;
            font-size: 16px;
        }

        #master-titan-toast.is-active {
            transform: translateX(-50%) translateY(0);
        }

    </style>
</head>
<body>

<div class="nebula-engine"><div class="nebula-orb orb-1"></div><div class="nebula-orb orb-2"></div><div class="nebula-orb orb-3"></div></div>

<div id="master-boot-screen">
    <div class="boot-branding">
        <div class="boot-logo-text">VIBE OS</div>
    </div>
    <div class="boot-track"><div class="boot-track-fill"></div></div>
    <div class="boot-log-txt">QUANTUM ARCHITECTURE ENGAGED</div>
</div>

<div id="master-app-viewport">
    
    <div class="master-header">
        <div class="master-brand">VIBE <span>SUPREME</span></div>
        <div class="master-btn-round" onclick="App.open('settings')"><i class="fa-solid fa-microchip"></i></div>
    </div>

    <div id="master-scroll-container">
        
        <div class="bi-grid">
            
            <div class="bi-card bi-card-hero" onclick="App.open('settings')">
                <div>
                    <div class="bi-label">IDENTITY PROTOCOL</div>
                    <div id="ui-monolith-user-name" class="bi-value">××•×¨×—</div>
                </div>
                <div style="text-align: left;">
                    <div class="bi-label">QUANTUM FILTERS</div>
                    <div id="ui-monolith-filters-active" style="color:var(--plasma-cyan); font-weight:1000; font-size:18px;">0 ×¤×¢×™×œ×™×</div>
                </div>
            </div>

            <div class="bi-card" onclick="App.open('ring')">
                <div class="bi-label">BIOMETRIC SYNC</div>
                <div id="ui-monolith-ring-label" class="bi-value" style="color:var(--g-a); font-size:32px;">×ª×§×™×Ÿ</div>
                <div class="bi-sub-titan">Real-time Bio-Vibe Active</div>
            </div>

            <div class="bi-card bi-card-score" onclick="App.open('cart')">
                <div id="ui-monolith-grade-badge" class="score-badge-monolith">A</div>
                <div style="text-align:right; width:100%;">
                    <div class="bi-label">INTELLIGENT CART QUALITY</div>
                    <div id="ui-monolith-score-pct" class="bi-value">100%</div>
                    <div class="bi-gauge-system"><div id="ui-monolith-gauge-fill" class="bi-gauge-fill-monolith"></div></div>
                    <div class="bi-sub-titan"><span id="ui-monolith-cart-total-count">0</span> ×¤×¨×™×˜×™× ×××•××ª×™× ×‘×¡×œ</div>
                </div>
            </div>

        </div>

        <div class="section-title-architect" style="padding:0 40px; margin-top:20px; font-size:15px; font-weight:1000; color:#64748b; text-transform:uppercase; letter-spacing:3px; margin-bottom:15px;">×—×™×¤×•×© ×•×–×™×”×•×™ FUZZY v6</div>
        <div class="lookup-matrix-container">
            <input type="text" id="inp-architect-lookup" class="lookup-input-master" placeholder="×”×§×œ×“ ×©× ××•×¦×¨, ××•×ª×’ ××• ×‘×¨×§×•×“...">
            <button class="lookup-btn-master" onclick="Cart.executeMonolithLookup()">ğŸ”</button>
        </div>

        <div id="ui-monolith-pills-container" class="dashboard-tags-cloud"></div>

    </div>

    <div class="dock-titan-absolute-wrap">
        <div class="dock-titan-monolith-bar">
            
            <div class="dock-monolith-trigger" onclick="App.open('cart')">
                <i class="fa-solid fa-basket-shopping"></i>
                <span>×¢×’×œ×”</span>
            </div>
            
            <div class="scanner-monolith-fab-anchor">
                <div class="scanner-fab-core-monolith" onclick="Scanner.deployQuantumEngine()">
                    <div class="scan-monolith-viz">
                        <div class="vector-barcode-supreme">
                            <span class="vector-bar-segment"></span><span class="vector-bar-segment"></span>
                            <span class="vector-bar-segment"></span><span class="vector-bar-segment"></span>
                        </div>
                        <div class="scan-monolith-text">SCAN</div>
                    </div>
                </div>
            </div>

            <div class="dock-monolith-trigger" onclick="App.open('history')">
                <i class="fa-solid fa-database"></i>
                <span>Vault</span>
            </div>

        </div>
    </div>

    <div id="master-titan-toast">ENGINE READY</div>

    <div id="modal-settings" class="monolith-modal-overlay"><div class="monolith-master-sheet">
        <div class="sheet-header-supreme"><div class="sheet-title-supreme">TITAN PREFERENCE ENGINE</div><div class="sheet-close-supreme" onclick="App.close('settings')">âœ•</div></div>
        <div class="sheet-scroll-monolith" id="monolith-settings-payload">
            <input type="text" id="inp-architect-identity" placeholder="×”×’×“×¨ ×–×”×•×ª ××¨×›×™×˜×§×˜" style="width:100%; padding:28px; background:rgba(255,255,255,0.08); border:none; border-radius:36px; color:#fff; margin-bottom:45px; text-align:right; font-size:24px; font-weight:1000; box-shadow: inset 0 5px 20px rgba(0,0,0,0.7);">
            
            <div class="param-acc-monolith theme-qual"><div class="param-acc-header" onclick="App.togAcc(this)">ğŸ… ×“×™×¨×•×’ ××™×›×•×ª ×•××™××•×ª <span>â–¼</span></div><div class="param-acc-body">
                <input type="checkbox" id="q-aplus" class="param-chip-titan-input"><label for="q-aplus" class="param-chip-titan-label"><i class="fa-solid fa-crown"></i> A+ ×‘×œ×‘×“</label>
                <input type="checkbox" id="q-green" class="param-chip-titan-input"><label for="q-green" class="param-chip-titan-label"><i class="fa-solid fa-circle-check"></i> ×ª×• ×™×¨×•×§ (××©×¨×“ ×”×‘×¨×™××•×ª)</label>
                <input type="checkbox" id="q-natural" class="param-chip-titan-input"><label for="q-natural" class="param-chip-titan-label"><i class="fa-solid fa-tree"></i> 100% ×˜×‘×¢×™</label>
                <input type="checkbox" id="q-nored" class="param-chip-titan-input"><label for="q-nored" class="param-chip-titan-label"><i class="fa-solid fa-ban"></i> ×œ×œ× ××“×‘×§×•×ª ××“×•××•×ª</label>
                <input type="checkbox" id="q-nova" class="param-chip-titan-input"><label for="q-nova" class="param-chip-titan-label"><i class="fa-solid fa-flask-vial"></i> NOVA 1-2 (×¢×™×‘×•×“ × ××•×š)</label>
                <input type="checkbox" id="q-pest" class="param-chip-titan-input"><label for="q-pest" class="param-chip-titan-label"><i class="fa-solid fa-spider"></i> ×œ×œ× ×—×•××¨×™ ×”×“×‘×¨×”</label>
                <input type="checkbox" id="q-micro" class="param-chip-titan-input"><label for="q-micro" class="param-chip-titan-label"><i class="fa-solid fa-bacteria"></i> ×œ×œ× ××™×§×¨×•-×¤×œ×¡×˜×™×§</label>
                <input type="checkbox" id="q-frsh" class="param-chip-titan-input"><label for="q-frsh" class="param-chip-titan-label"><i class="fa-solid fa-wind"></i> ×˜×¨×™×•×ª ××§×¡×™××œ×™×ª</label>
            </div></div>

            <div class="param-acc-monolith theme-med"><div class="param-acc-header" onclick="App.togAcc(this)">âš ï¸ ××œ×¨×’×™×•×ª (MEDICAL VETO) <span>â–¼</span></div><div class="param-acc-body">
                <input type="checkbox" id="a-milk" class="param-chip-titan-input"><label for="a-milk" class="param-chip-titan-label">×—×œ×‘</label>
                <input type="checkbox" id="a-gluten" class="param-chip-titan-input"><label for="a-gluten" class="param-chip-titan-label">×’×œ×•×˜×Ÿ (×—×™×˜×”)</label>
                <input type="checkbox" id="a-nuts" class="param-chip-titan-input"><label for="a-nuts" class="param-chip-titan-label">××’×•×–×™ ×¢×¥</label>
                <input type="checkbox" id="a-peanuts" class="param-chip-titan-input"><label for="a-peanuts" class="param-chip-titan-label">×‘×•×˜× ×™×</label>
                <input type="checkbox" id="a-sesame" class="param-chip-titan-input"><label for="a-sesame" class="param-chip-titan-label">×©×•××©×•×</label>
                <input type="checkbox" id="a-soy" class="param-chip-titan-input"><label for="a-soy" class="param-chip-titan-label">×¡×•×™×”</label>
                <input type="checkbox" id="a-eggs" class="param-chip-titan-input"><label for="a-eggs" class="param-chip-titan-label">×‘×™×¦×™×</label>
                <input type="checkbox" id="a-fish" class="param-chip-titan-input"><label for="a-fish" class="param-chip-titan-label">×“×’×™×</label>
                <input type="checkbox" id="a-shell" class="param-chip-titan-input"><label for="a-shell" class="param-chip-titan-label">×¤×™×¨×•×ª ×™×</label>
                <input type="checkbox" id="a-mustard" class="param-chip-titan-input"><label for="a-mustard" class="param-chip-titan-label">×—×¨×“×œ</label>
                <input type="checkbox" id="a-celery" class="param-chip-titan-input"><label for="a-celery" class="param-chip-titan-label">×¡×œ×¨×™</label>
                <input type="checkbox" id="a-sulfites" class="param-chip-titan-input"><label for="a-sulfites" class="param-chip-titan-label">×¡×•×œ×¤×™×˜×™×</label>
                <input type="checkbox" id="a-lupin" class="param-chip-titan-input"><label for="a-lupin" class="param-chip-titan-label">×ª×•×¨××•×¡</label>
                <input type="checkbox" id="a-corn" class="param-chip-titan-input"><label for="a-corn" class="param-chip-titan-label">×ª×™×¨×¡</label>
                <input type="checkbox" id="a-beans" class="param-chip-titan-input"><label for="a-beans" class="param-chip-titan-label">×¤×•×œ (G6PD)</label>
                <input type="checkbox" id="a-strawberry" class="param-chip-titan-input"><label for="a-strawberry" class="param-chip-titan-label">×ª×•×ª ×©×“×”</label>
            </div></div>

            <div class="param-acc-monolith theme-med"><div class="param-acc-header" onclick="App.togAcc(this)">ğŸ¥ ××¦×‘ ×¨×¤×•××™ (×•×˜×• ×—××•×¨) <span>â–¼</span></div><div class="param-acc-body">
                <input type="checkbox" id="m-diabetes" class="param-chip-titan-input"><label for="m-diabetes" class="param-chip-titan-label"><i class="fa-solid fa-droplet"></i> ×¡×•×›×¨×ª (×•×˜×• ×¡×•×›×¨)</label>
                <input type="checkbox" id="m-celiac" class="param-chip-titan-input"><label for="m-celiac" class="param-chip-titan-label"><i class="fa-solid fa-wheat-awn"></i> ×¦×œ×™××§ (×•×˜×• ×’×œ×•×˜×Ÿ)</label>
                <input type="checkbox" id="m-pressure" class="param-chip-titan-input"><label for="m-pressure" class="param-chip-titan-label"><i class="fa-solid fa-heart-pulse"></i> ×œ×—×¥ ×“× (×•×˜×• × ×ª×¨×Ÿ)</label>
                <input type="checkbox" id="m-heart" class="param-chip-titan-input"><label for="m-heart" class="param-chip-titan-label"><i class="fa-solid fa-heart"></i> ×‘×¨×™××•×ª ×”×œ×‘ (×•×˜×• ×©×•××Ÿ)</label>
                <input type="checkbox" id="m-kidney" class="param-chip-titan-input"><label for="m-kidney" class="param-chip-titan-label"><i class="fa-solid fa-stethoscope"></i> ×›×œ×™×•×ª (××©×œ×’×Ÿ/×–×¨×—×Ÿ)</label>
                <input type="checkbox" id="m-gout" class="param-chip-titan-input"><label for="m-gout" class="param-chip-titan-label"><i class="fa-solid fa-footprint"></i> ×’××•×˜ (×—×•××¦×ª ×©×ª×Ÿ)</label>
                <input type="checkbox" id="m-ibs" class="param-chip-titan-input"><label for="m-ibs" class="param-chip-titan-label"><i class="fa-solid fa-pills"></i> ××¢×™ ×¨×’×™×– (FODMAP)</label>
                <input type="checkbox" id="m-reflux" class="param-chip-titan-input"><label for="m-reflux" class="param-chip-titan-label"><i class="fa-solid fa-fire-burner"></i> ×¦×¨×‘×ª / ×¨×™×¤×œ×•×§×¡</label>
                <input type="checkbox" id="m-chol" class="param-chip-titan-input"><label for="m-chol" class="param-chip-titan-label"><i class="fa-solid fa-burger"></i> ×›×•×œ×¡×˜×¨×•×œ ×’×‘×•×”</label>
                <input type="checkbox" id="m-migraine" class="param-chip-titan-input"><label for="m-migraine" class="param-chip-titan-label"><i class="fa-solid fa-head-side-virus"></i> ××™×’×¨× ×•×ª</label>
            </div></div>

            <div class="param-acc-monolith theme-diet"><div class="param-acc-header" onclick="App.togAcc(this)">ğŸ¥— ×“×™××˜×” ×•××•×¨×— ×—×™×™× <span>â–¼</span></div><div class="param-acc-body">
                <input type="checkbox" id="l-vegan" class="param-chip-titan-input"><label for="l-vegan" class="param-chip-titan-label">×˜×‘×¢×•× ×™</label>
                <input type="checkbox" id="l-veg" class="param-chip-titan-input"><label for="l-veg" class="param-chip-titan-label">×¦××—×•× ×™</label>
                <input type="checkbox" id="l-keto" class="param-chip-titan-input"><label for="l-keto" class="param-chip-titan-label">×§×˜×• (Keto)</label>
                <input type="checkbox" id="l-paleo" class="param-chip-titan-input"><label for="l-paleo" class="param-chip-titan-label">×¤×œ×™××• (Paleo)</label>
                <input type="checkbox" id="l-lowcarb" class="param-chip-titan-input"><label for="l-lowcarb" class="param-chip-titan-label">×“×œ ×¤×—××™××”</label>
                <input type="checkbox" id="l-organic" class="param-chip-titan-input"><label for="l-organic" class="param-chip-titan-label">××•×¨×’× ×™</label>
                <input type="checkbox" id="l-clean" class="param-chip-titan-input"><label for="l-clean" class="param-chip-titan-label">×ª×•×•×™×ª × ×§×™×™×” (Clean Label)</label>
                <input type="checkbox" id="l-whole30" class="param-chip-titan-input"><label for="l-whole30" class="param-chip-titan-label">Whole30</label>
                <input type="checkbox" id="l-med" class="param-chip-titan-input"><label for="l-med" class="param-chip-titan-label">×™× ×ª×™×›×•× ×™</label>
            </div></div>

            <div class="param-acc-monolith theme-chem"><div class="param-acc-header" onclick="App.togAcc(this)">ğŸ§ª ×¨×›×™×‘×™× ×œ×”×™×× ×¢×•×ª <span>â–¼</span></div><div class="param-acc-body">
                <input type="checkbox" id="x-sugar" class="param-chip-titan-input"><label for="x-sugar" class="param-chip-titan-label">×¡×•×›×¨ ×œ×‘×Ÿ</label>
                <input type="checkbox" id="x-proc" class="param-chip-titan-input"><label for="x-proc" class="param-chip-titan-label">××–×•×Ÿ ××¢×•×‘×“</label>
                <input type="checkbox" id="x-caff" class="param-chip-titan-input"><label for="x-caff" class="param-chip-titan-label">×§×¤××™×Ÿ</label>
                <input type="checkbox" id="x-palm" class="param-chip-titan-input"><label for="x-palm" class="param-chip-titan-label">×©××Ÿ ×“×§×œ×™×</label>
                <input type="checkbox" id="x-msg" class="param-chip-titan-input"><label for="x-msg" class="param-chip-titan-label">××•× ×•×¡×•×“×™×•× (MSG)</label>
                <input type="checkbox" id="x-trans" class="param-chip-titan-input"><label for="x-trans" class="param-chip-label">×©×•××Ÿ ×˜×¨×× ×¡</label>
                <input type="checkbox" id="x-colors" class="param-chip-titan-input"><label for="x-colors" class="param-chip-titan-label">×¦×‘×¢×™ ×××›×œ</label>
                <input type="checkbox" id="x-preserv" class="param-chip-titan-input"><label for="x-preserv" class="param-chip-titan-label">×—×•××¨×™× ××©××¨×™×</label>
                <input type="checkbox" id="x-sweet" class="param-chip-titan-input"><label for="x-sweet" class="param-chip-titan-label">×××ª×™×§×™× ××œ××›×•×ª×™×™×</label>
                <input type="checkbox" id="x-hfc" class="param-chip-titan-input"><label for="x-hfc" class="param-chip-titan-label">×¡×™×¨×•×¤ ×ª×™×¨×¡</label>
                <input type="checkbox" id="x-phos" class="param-chip-titan-input"><label for="x-phos" class="param-chip-titan-label">×–×¨×—×Ÿ ×¡×™× ×ª×˜×™</label>
            </div></div>

            <div class="param-acc-monolith theme-kosh"><div class="param-acc-header" onclick="App.togAcc(this)">âœ¡ï¸ ×“×ª ×•×›×©×¨×•×ª <span>â–¼</span></div><div class="param-acc-body">
                <input type="checkbox" id="k-kosher" class="param-chip-titan-input"><label for="k-kosher" class="param-chip-titan-label">×›×©×¨ ×¨×’×™×œ</label>
                <input type="checkbox" id="k-badatz" class="param-chip-titan-input"><label for="k-badatz" class="param-chip-titan-label">âœ¨ ×‘×“"×¥ ×‘×œ×‘×“</label>
                <input type="checkbox" id="k-mehadrin" class="param-chip-titan-input"><label for="k-mehadrin" class="param-chip-titan-label">××”×“×¨×™×Ÿ</label>
                <input type="checkbox" id="k-parve" class="param-chip-titan-input"><label for="k-parve" class="param-chip-titan-label">×¤×¨×•×•×” ×‘×œ×‘×“</label>
                <input type="checkbox" id="k-passover" class="param-chip-titan-input"><label for="k-passover" class="param-chip-titan-label">×›×©×¨ ×œ×¤×¡×—</label>
                <input type="checkbox" id="k-halal" class="param-chip-titan-input"><label for="k-halal" class="param-chip-titan-label">ğŸ•Œ ×—×œ××œ</label>
            </div></div>

            <div class="param-acc-monolith theme-ethic"><div class="param-acc-header" onclick="App.togAcc(this)">ğŸŒ ××ª×™×§×” ×•×¡×‘×™×‘×” <span>â–¼</span></div><div class="param-acc-body">
                <input type="checkbox" id="e-fair" class="param-chip-titan-input"><label for="e-fair" class="param-chip-titan-label">×¡×—×¨ ×”×•×’×Ÿ</label>
                <input type="checkbox" id="e-local" class="param-chip-titan-input"><label for="e-local" class="param-chip-titan-label">ğŸ‡®ğŸ‡± ×ª×•×¦×¨×ª ×”××¨×¥</label>
                <input type="checkbox" id="e-recycle" class="param-chip-titan-input"><label for="e-recycle" class="param-chip-titan-label">××¨×™×–×” ××ª×›×œ×”</label>
                <input type="checkbox" id="e-gmo" class="param-chip-titan-input"><label for="e-gmo" class="param-chip-titan-label">×œ×œ× ×”× ×“×¡×” ×’× ×˜×™×ª</label>
                <input type="checkbox" id="e-animal" class="param-chip-titan-input"><label for="e-animal" class="param-chip-titan-label">×œ×œ× × ×™×¡×•×™×™× ×‘×‘×¢"×—</label>
            </div></div>

        </div>
        <div class="sheet-footer-monolith"><button class="btn-titan-architect btn-architect-primary" onclick="User.deploySupremeProfile()"><i class="fa-solid fa-dna"></i> ×‘×¦×¢ ×¤×¨×™×¡×ª ×¤×¨×•×¤×™×œ</button></div>
    </div></div>

    <div id="modal-result" class="monolith-modal-overlay"><div class="monolith-master-sheet">
        <div class="sheet-header-supreme"><div>× ×™×ª×•×— TITAN ×¡×•×¤×™</div><div class="sheet-close-supreme" onclick="App.close('result')">âœ•</div></div>
        <div class="sheet-scroll-monolith" style="text-align:center;">
            <div id="res-titan-orb" class="grade-orb-supreme-monolith">A</div>
            <h2 id="res-monolith-name" style="font-size:46px; font-weight:1000; line-height:1; margin-bottom:12px;">×©× ××•×¦×¨</h2>
            <div id="res-monolith-brand" style="color:#94a3b8; font-size:22px; margin-bottom:40px; font-weight:600;">××•×ª×’ ×”××¢×¨×›×ª</div>
            <div id="res-titan-report" class="intelligence-report-card"></div>
            
            <div id="res-monolith-prices" style="margin-top:45px; display:grid; grid-template-columns:1fr 1fr; gap:18px;"></div>
        </div>
        <div class="sheet-footer-monolith" style="display:grid; grid-template-columns:1fr 1fr; gap:20px;">
            <button class="btn-titan-architect btn-architect-primary" onclick="Cart.addMonolithValidated(true)">+ ×œ×‘×™×ª</button>
            <button class="btn-titan-architect btn-architect-secondary" onclick="Cart.addMonolithValidated(false)">+ ×œ×™</button>
        </div>
    </div></div>

    <div id="modal-cart" class="monolith-modal-overlay"><div class="monolith-master-sheet">
        <div class="sheet-header-supreme"><div>×¡×œ ×§× ×™×•×ª ×××•××ª v6</div><div class="sheet-close-supreme" onclick="App.close('cart')">âœ•</div></div>
        <div class="sheet-scroll-monolith" id="ui-monolith-cart-payload"></div>
        <div class="sheet-footer-monolith"><button class="btn-titan-architect btn-architect-secondary" style="color:var(--g-e); border-color:rgba(255,0,0,0.3);" onclick="Cart.monolithPurge()">Purge All Cart Data</button></div>
    </div></div>

    <div id="modal-history" class="monolith-modal-overlay"><div class="monolith-master-sheet">
        <div class="sheet-header-supreme"><div>THE VAULT - BI ANALYTICS</div><div class="sheet-close-supreme" onclick="App.close('history')">âœ•</div></div>
        <div class="sheet-scroll-monolith">
            <div class="bi-vault-panel">
                <div class="bi-date-row">
                    <input type="date" id="vault-bi-start-date" class="inp-vault" onchange="History.vaultSync()">
                    <input type="date" id="vault-bi-end-date" class="inp-vault" onchange="History.vaultSync()">
                </div>
                <input type="text" id="vault-bi-search-input" class="lookup-input-master search-vault" style="width:100%; margin-bottom:20px;" placeholder="×—×¤×© ××•×¦×¨ ××• ××•×ª×’ ×‘××¨×›×™×•×Ÿ..." onkeyup="History.vaultSync()">
                <div id="vault-bi-grade-filters" class="grade-bi-chips"></div>
                <div class="agg-mode-switch" onclick="History.toggleVaultAggregation()">
                    <span>ğŸ“‚ ××¦×‘ ×¦××¦×•× (Aggregation Mode)</span><span id="agg-status-vault-ui" style="color:var(--plasma-cyan);">OFF</span>
                </div>
            </div>
            <div id="ui-monolith-vault-list"></div>
        </div>
    </div></div>

    <div id="modal-ring" class="monolith-modal-overlay"><div class="monolith-master-sheet" style="height:auto;">
        <div class="sheet-header-supreme"><div>BIO-SYNC RING v7</div><div class="sheet-close-supreme" onclick="App.close('ring')">âœ•</div></div>
        <div class="sheet-body" style="display:grid; grid-template-columns:1fr 1fr; gap:25px; padding:50px;">
            <button class="btn-titan-architect btn-architect-secondary" onclick="App.monolithSyncRing('normal')">ğŸŸ¢ ×¨×’×™×œ</button>
            <button class="btn-titan-architect btn-architect-secondary" onclick="App.monolithSyncRing('stress')">ğŸ¤¯ ×¡×˜×¨×¡</button>
            <button class="btn-titan-architect btn-architect-secondary" onclick="App.monolithSyncRing('sick')">ğŸ¤’ ×—×•×œ×™</button>
            <button class="btn-titan-architect btn-architect-secondary" onclick="App.monolithSyncRing('sugar')">ğŸ©¸ ×¡×•×›×¨</button>
            <button class="btn-titan-architect btn-architect-secondary" onclick="App.monolithSyncRing('sport')">ğŸ’ª ××™××•×Ÿ</button>
            <button class="btn-titan-architect btn-architect-secondary" onclick="App.monolithSyncRing('tired')">ğŸ˜´ ×¢×™×™×¤×•×ª</button>
        </div>
    </div></div>

    <div id="master-quantum-scanner-viewport">
        <div id="qr-engine-monolith-instance"></div>
        <div class="quantum-hud-monolith">
            <div class="quantum-scanner-frame">
                <div class="quantum-edge"></div>
                <div class="quantum-scanner-laser"></div>
            </div>
        </div>
        <div style="position:absolute; bottom:80px; width:100%; display:flex; justify-content:center; z-index:5001;">
            <button onclick="Scanner.disengageQuantum()" style="background:rgba(0,0,0,0.75); border:3px solid rgba(255,255,255,0.5); color:#fff; padding:24px 70px; border-radius:60px; font-weight:1000; cursor:pointer; backdrop-filter:blur(25px); letter-spacing:4px; box-shadow: 0 0 50px rgba(0,0,0,0.8);">TERMINATE ENGINE</button>
        </div>
    </div>

</div>

<script>
    /* =========================================================================
       TITAN SUPREME MONOLITH CORE v7.2
       ARCHITECT: ABSOLUTE QUANTUM IMPLEMENTATION
       ========================================================================= */

    // --- 1. DATA MONOLITH (SINGLETON GENERATOR - 2500 ITEMS) ---
    const BRANDS_MONOLITH = ['×ª× ×•×‘×”','×©×˜×¨××•×¡','××¡×','×¢×œ×™×ª','×˜×¨×”','×¨××™ ×œ×•×™','×©×•×¤×¨×¡×œ','×˜×‘×¢×•×œ','×§×¨×¤×•×¨ IL','×™×•×—× × ×•×£','×•×™×§×˜×•×¨×™','× ×™×¦×ª ×”×“×•×‘×“×‘×Ÿ','×”× ××œ','×¡×•×’×ª','×•×™×¡×•×¦×§×™','×‘×œ×“×™','×˜×™×¨×ª ×¦×‘×™','×–×•×’×œ×•×‘×§','×¢×•×£ ×˜×•×‘','×××× ×¢×•×£','××—×œ×‘×•×ª ×¨××ª ×”×’×•×œ×Ÿ','×’×“','×”×©×“×”','××•×¨×’× ×™×§','×‘××“×™','××™×œ×§×™','×§×•×§×” ×§×•×œ×”','×”×™×™× ×¥','×”×œ×× ×¡','×§× ×•×¨','×¡×˜××¨×§×™×¡×˜','×¤×•×¡×™×“×•×Ÿ','×™×“ ××¨×“×›×™','×™×›×™×Ÿ','×¤×¨×™ × ×™×¨','×¡× ×¤×¨×•×¡×˜','××¢×“× ×•×ª','×©×œ×•×©×ª ×”××•×¤×™×','×‘×Ÿ ×× ×“ ×’\'×¨×™×¡','×’×•×œ×“×”','× ×‘×™×¢×•×ª','××™ ×¢×“×Ÿ'];
    
    const PRODUCTS_TITAN_TEMPLATES = [
        {n:'×œ×—× ××œ× 100%', cat:'bakery', g:'A', sugar:1.8, salt:410, tags:['gl','local','green','natural','vegan']},
        {n:'×—×œ×‘ 3% ×˜×¨×™', cat:'dairy', g:'B', sugar:4.8, salt:50, tags:['da','local']},
        {n:'××™×œ×§×™ ×¢× ×§×¦×¤×ª', cat:'dairy', g:'E', sugar:16, salt:75, tags:['da','sug','proc','additive']},
        {n:'××œ×¤×¤×•×Ÿ ×‘×œ××“×™ ×˜×¨×™', cat:'fresh', g:'A+', sugar:0.7, salt:2, tags:['fresh','natural','low-glycemic','green']},
        {n:'×§×•×œ×” ×–×™×¨×•', cat:'drink', g:'D', sugar:0, salt:16, tags:['caff','proc','artificial']},
        {n:'×˜×—×™× ×” ×’×•×œ××™×ª ××©×•××©×•×', cat:'pantry', g:'A+', sugar:0.4, salt:12, tags:['ses','local','natural','superfood']},
        {n:'×‘××‘×” ×§×œ××¡×™×ª', cat:'snack', g:'B', sugar:2.5, salt:380, tags:['nut','local']},
        {n:'×©× ×™×¦×œ ×ª×™×¨×¡ ××©×¤×—×ª×™', cat:'frozen', g:'C', sugar:3.8, salt:590, tags:['gl','proc','additive']},
        {n:'×¤×¡×˜×” ×‘×¨×™×œ×” ××§×•×¨×™', cat:'pantry', g:'B', sugar:0.9, salt:5, tags:['gl']},
        {n:'×—×•××•×¡ ××¡×œ×™ ×××™×ª×™', cat:'pantry', g:'D', sugar:1.6, salt:550, tags:['proc','local','salt','additive']},
        {n:'×‘×™×¦×™× ×˜×¨×™×•×ª L', cat:'fresh', g:'A', sugar:0.3, salt:125, tags:['eggs','local','natural']},
        {n:'×™×•×’×•×¨×˜ BIO ×œ×‘×Ÿ', cat:'dairy', g:'A+', sugar:3.9, salt:48, tags:['da','natural','green']},
        {n:'×©××Ÿ ×–×™×ª ×›×ª×™×ª ××¢×•×œ×”', cat:'pantry', g:'A+', sugar:0, salt:0, tags:['local','natural','superfood']},
        {n:'×—×××ª ×‘×•×˜× ×™× ×˜×‘×¢×™×ª', cat:'pantry', g:'A', sugar:1.7, salt:12, tags:['nut','natural','vegan']},
        {n:'×¡×œ×˜ ×˜×•× ×” ×‘×©××Ÿ', cat:'pantry', g:'C', sugar:2, salt:500, tags:['fish','proc','salt']},
        {n:'××•×¨×– ×¤×¨×¡×™ ×§×œ××¡×™', cat:'pantry', g:'B', sugar:0.2, salt:5, tags:['local']},
        {n:'×§×•×¨× ×¤×œ×§×¡ ×ª×œ××”', cat:'pantry', g:'C', sugar:8, salt:450, tags:['gl','sug','proc']},
        {n:'×§×•×¡×§×•×¡ ××”×™×¨', cat:'pantry', g:'C', sugar:1, salt:10, tags:['gl','local']},
        {n:'×©×•×§×•×œ×“ ×¤×¨×” ×¢×œ×™×ª', cat:'snack', g:'E', sugar:55, salt:100, tags:['da','sug','proc']},
        {n:'×¤×™×ª×” ×›×•×¡××™×Ÿ ××œ×', cat:'bakery', g:'A', sugar:1.5, salt:380, tags:['gl','local','green']},
        {n:'×§×•×˜×’\' 5% ×˜×¨×™', cat:'dairy', g:'A', sugar:3, salt:350, tags:['da','local']},
        {n:'×ª×¤×•×— ×¢×¥ ×™×¨×•×§', cat:'fresh', g:'A+', sugar:10, salt:0, tags:['fresh','natural','sug']},
        {n:'×’×‘×™× ×” ×¦×”×•×‘×” ×¢××§', cat:'dairy', g:'D', sugar:0.5, salt:650, tags:['da','proc','salt']}
    ];

    let MASTER_MONOLITH_DB = [];
    for(let i=0; i<2500; i++) {
        const base = PRODUCTS_TITAN_TEMPLATES[i % PRODUCTS_TITAN_TEMPLATES.length];
        const brand = BRANDS_MONOLITH[i % BRANDS_MONOLITH.length];
        let g = base.g;
        // Dynamic Grading drift logic
        if(g==='B' && Math.random()>0.5) g='B+'; 
        MASTER_MONOLITH_DB.push({ ...base, b: brand, fullName: `${base.n} ${brand}`, g: g, id: (7290000 + i).toString() });
    }

    // --- 2. THE ABSOLUTE STATE CONTROLLER ---
    let State = { 
        user: {name:'××•×¨×—', filters:[]}, 
        cart: [], 
        history: [], 
        ring: 'normal', 
        temp: null, 
        isAgg: false, 
        vaultGrades: [] 
    };

    const App = {
        init: function() {
            this.bootSync();
            this.buildVaultFilters();
            
            // TITAN BOOT SEQUENCE
            setTimeout(() => {
                const boot = document.getElementById('master-boot-screen');
                boot.style.opacity = 0;
                setTimeout(() => { 
                    boot.remove(); 
                    document.getElementById('titan-app-frame').classList.add('active');
                }, 1000);
            }, 3500);
            this.globalUpdate();
        },
        bootSync: function() {
            const u=localStorage.getItem('vMonolith_user'); if(u) State.user=JSON.parse(u);
            const c=localStorage.getItem('vMonolith_cart'); if(c) State.cart=JSON.parse(c);
            const h=localStorage.getItem('vMonolith_hist'); if(h) State.history=JSON.parse(h);
        },
        saveAll: function() {
            localStorage.setItem('vMonolith_user', JSON.stringify(State.user));
            localStorage.setItem('vMonolith_cart', JSON.stringify(State.cart));
            localStorage.setItem('vMonolith_hist', JSON.stringify(State.history));
        },
        globalUpdate: function() {
            document.getElementById('ui-monolith-user-name').innerText = State.user.name;
            document.getElementById('ui-monolith-filters-active').innerText = State.user.filters.length + ' ×”×’×“×¨×•×ª ×¤×¢×™×œ×•×ª';
            this.updateDashboardBI();
        },
        updateDashboardBI: function() {
            const rMap = {'normal':'×ª×§×™×Ÿ','stress':'×¡×˜×¨×¡ ğŸ¤¯','sick':'×—×•×œ×™ ğŸ¤’','sugar':'× ×¤×™×œ×ª ×¡×•×›×¨ ğŸ©¸','sport':'××™××•×Ÿ ğŸ’ª','tired':'×¢×™×™×¤×•×ª ğŸ˜´'};
            document.getElementById('ui-monolith-ring-label').innerText = rMap[State.ring] || '×ª×§×™×Ÿ';
            
            // CALCULATE CART INTELLIGENCE
            let score=100; if(State.cart.length>0){ let t=0; State.cart.forEach(i=>t+=SCORES[i.g]||50); score=Math.round(t/State.cart.length); }
            document.getElementById('ui-score-percentage').innerText = score + '%';
            const bar = document.getElementById('ui-monolith-gauge-fill'); bar.style.width = score + '%';
            
            // DYNAMIC BADGE MAPPING
            let g='E'; if(score>=96)g='A+'; else if(score>=88)g='A'; else if(score>=82)g='B+'; else if(score>=72)g='B'; else if(score>=58)g='C'; else if(score>=38)g='D';
            const badge = document.getElementById('ui-monolith-grade-badge'); badge.innerText = g; badge.style.color = COLORS[g]; badge.style.borderColor = COLORS[g]; badge.style.boxShadow = `0 0 50px ${COLORS[g]}`;
            bar.style.background = COLORS[g];
            document.getElementById('ui-monolith-cart-total-count').innerText = State.cart.length;

            // RENDER ACTIVE PILL CLOUD
            const tMap = {'a-milk':'ğŸ¥› ×—×œ×‘','a-gluten':'ğŸ ×’×œ×•×˜×Ÿ','m-diabetes':'ğŸ’‰ ×¡×•×›×¨×ª','q-green':'âœ… ×™×¨×•×§','l-vegan':'ğŸŒ± ×˜×‘×¢×•× ×™','e-local':'ğŸ‡®ğŸ‡± ××§×•××™','q-aplus':'ğŸ‘‘ A+ ×‘×œ×‘×“'};
            document.getElementById('ui-monolith-pills-container').innerHTML = State.user.filters.slice(0,8).map(f => `<div class="titan-pills-master">${tMap[f]||f.split('-')[1]}</div>`).join('');
        },
        open: function(id) { document.getElementById('modal-'+id).classList.add('active'); if(id==='cart') Cart.render(); if(id==='history') History.vaultSync(); if(id==='settings') User.loadUI(); },
        close: function(id) { document.getElementById('modal-'+id).classList.remove('active'); },
        buildVaultFilters: function() {
            const grades = ['A+','A','B+','B','C','D','E'];
            document.getElementById('vault-bi-grade-filters').innerHTML = grades.map(g => `<div class="bi-chip" onclick="History.toggleBiGrade(this,'${g}')">${g}</div>`).join('');
            document.getElementById('vault-bi-end-date').valueAsDate = new Date();
            let d = new Date(); d.setMonth(d.getMonth()-6);
            document.getElementById('vault-bi-start-date').valueAsDate = d;
        },
        monolithSyncRing: function(s) { State.ring=s; this.saveAll(); this.globalUpdate(); this.close('ring'); this.toast('×‘×™×•-×¡×™× ×›×¨×•×Ÿ ×”×•×©×œ×'); },
        toast: function(m) { const t=document.getElementById('master-titan-toast'); t.innerText=m; t.classList.add('is-active'); setTimeout(()=>t.classList.remove('is-active'),3000); },
        togAcc: function(el) { el.parentElement.classList.toggle('is-open'); }
    };

    const Cart = {
        // SUPREME FUZZY LOOKUP ENGINE v2
        executeMonolithLookup: function() {
            const query = document.getElementById('inp-architect-lookup').value.toLowerCase().trim();
            if(!query) return;
            
            // FUZZY MATCHING LOGIC
            let results = MASTER_MONOLITH_DB.filter(x => 
                x.id === query || 
                x.fullName.toLowerCase().includes(query) || 
                x.n.toLowerCase().includes(query) ||
                x.b.toLowerCase().includes(query)
            );
            
            if(results.length > 0) {
                // Priority Match (Heuristic)
                const best = results.find(r => r.id.startsWith('729')) || results[0];
                Scanner.analyzeQuantumMonolith(best);
            } else {
                // Fail-safe Synthesizer
                const synth = { n:query, b:'×–×™×”×•×™ ARCHITECT', g:'C', tags:[], sugar:0, salt:0, id:Date.now().toString() };
                Scanner.analyzeQuantumMonolith(synth);
            }
            document.getElementById('inp-architect-lookup').value='';
        },
        addMonolithValidated: function(home) {
            const item = { ...State.temp, t:new Date().toISOString(), u:home?'×‘×™×ª':'×× ×™' };
            State.cart.push(item); State.history.unshift(item); App.saveAll(); App.close('result'); App.globalUpdate(); App.toast('× ×™×ª×•×— TITAN ×”×•×¡×£');
        },
        monolithPurge: function() { if(confirm('×œ××—×•×§ ××ª ×›×œ × ×ª×•× ×™ ×”×¡×œ?')){ State.cart=[]; App.saveAll(); App.globalUpdate(); App.close('cart'); } },
        render: function() {
            const con=document.getElementById('ui-monolith-cart-payload');
            if(State.cart.length===0){ con.innerHTML='<div style="text-align:center; padding:100px; color:#64748b; font-weight:1000; letter-spacing:3px; text-transform:uppercase;">×¡×œ ×¨×™×§ - ×× × ×¡×¨×•×§ ××•×¦×¨</div>'; return; }
            con.innerHTML = State.cart.map((i,x)=>`
                <div class="supreme-list-row">
                    <div style="display:flex; align-items:center;">
                        <span class="grade-badge-supreme" style="background:${COLORS[i.g]}">${i.g}</span>
                        <div style="margin-right:30px;"><h4 style="font-size:22px; font-weight:1000;">${i.n}</h4><span style="font-size:15px; color:#64748b; font-weight:800;">${i.b} â€¢ ${i.u}</span></div>
                    </div>
                    <div style="color:var(--g-e); cursor:pointer; font-size:28px;" onclick="State.cart.splice(${x},1); App.saveAll(); Cart.render(); App.globalUpdate();"><i class="fa-solid fa-circle-xmark"></i></div>
                </div>`).join('');
        }
    };

    const History = {
        vaultSync: function() {
            const txt=document.getElementById('vault-bi-search-input').value.toLowerCase();
            const start=new Date(document.getElementById('vault-bi-start-date').value).getTime();
            const end=new Date(document.getElementById('vault-bi-end-date').value).getTime() + 86400000;
            let list = State.history.filter(i => {
                const t = new Date(i.t).getTime();
                const mDate = t>=start && t<=end;
                const mTxt = i.n.toLowerCase().includes(txt) || i.b.toLowerCase().includes(txt);
                const mGrade = State.vaultGrades.length === 0 || State.vaultGrades.includes(i.g);
                return mDate && mTxt && mGrade;
            });
            const con=document.getElementById('ui-monolith-vault-list');
            if(State.isAgg){
                let agg=new Map(); 
                list.forEach(i=>{ const k=i.n+i.b; if(!agg.has(k))agg.set(k,{...i,count:0}); agg.get(k).count++; });
                con.innerHTML = Array.from(agg.values()).map(i => `
                    <div class="supreme-list-row">
                        <div><h4 style="font-size:22px; font-weight:1000;">${i.n}</h4><span style="color:#666; font-weight:800;">${i.b}</span></div>
                        <div style="display:flex; align-items:center; gap:20px;"><div style="background:var(--plasma-indigo); color:#fff; padding:10px 24px; border-radius:20px; font-size:16px; font-weight:1000; box-shadow:0 8px 25px rgba(0,0,0,0.5);">x${i.count}</div><span class="grade-badge-supreme" style="background:${COLORS[i.g]}">${i.g}</span></div>
                    </div>`).join('');
            } else {
                con.innerHTML = list.map(i => `
                    <div class="supreme-list-row">
                        <div><h4 style="font-weight:1000; font-size:22px;">${i.n}</h4><span style="font-size:15px; color:#666; font-weight:800;">${i.b} â€¢ ${new Date(i.t).toLocaleDateString()}</span></div>
                        <span class="grade-badge-supreme" style="background:${COLORS[i.g]}">${i.g}</span>
                    </div>`).join('');
            }
        },
        toggleVaultAggregation: function() { State.isAgg=!State.isAgg; document.getElementById('ui-agg-status').innerText=State.isAgg?'ON':'OFF'; this.vaultSync(); },
        toggleBiGrade: function(el,g) { el.classList.toggle('active'); if(State.vaultGrades.includes(g)) State.vaultGrades=State.vaultGrades.filter(x=>x!==g); else State.vaultGrades.push(g); this.vaultSync(); }
    };

    const User = {
        deploySupremeProfile: function() {
            State.user.name = document.getElementById('inp-monolith-identity').value || '××•×¨×—';
            State.user.filters=[]; document.querySelectorAll('.param-chip-titan-input:checked').forEach(c=>State.user.filters.push(c.id));
            App.saveAll(); App.close('settings'); App.globalRefresh(); App.toast('××¨×›×™×˜×§×˜×•×¨×” × ×¤×¨×¡×”');
        },
        loadUI: function() {
            document.getElementById('inp-monolith-identity').value = State.user.name;
            document.querySelectorAll('.param-chip-titan-input').forEach(c => c.checked = State.user.filters.includes(c.id));
        }
    };

    const Scanner = {
        singletonInstance: null,
        deployQuantumEngine: function() {
            document.getElementById('master-quantum-scanner-viewport').style.display='flex';
            document.getElementById('master-quantum-scanner-viewport').classList.add('is-active');
            if(!this.singletonInstance) {
                this.singletonInstance = new Html5Qrcode("qr-engine-monolith-instance", { verbose: false });
            }
            // SUPREME FHD CONFIG v7
            const config = { 
                fps: 32, 
                qrbox: { width: 380, height: 380 }, 
                aspectRatio: 1.0, 
                videoConstraints: { 
                    facingMode: "environment", 
                    focusMode: "continuous", 
                    width: { ideal: 1920 }, 
                    height: { ideal: 1080 } 
                },
                experimentalFeatures: { useBarCodeDetectorIfSupported: true }
            };
            this.singletonInstance.start({ facingMode: "environment" }, config, (txt)=>{
                this.disengageQuantum(); 
                let p = MASTER_MONOLITH_DB.find(x=>x.id===txt); 
                this.analyzeQuantumMonolith(p || { n:'×œ× ×–×•×”×”', b:'×›×œ×œ×™', g:'D', tags:[], sugar:0, salt:0, id:txt });
            }).catch(()=>{ 
                // Simulation Fallback for Demo
                setTimeout(()=> { this.disengageQuantum(); this.analyzeQuantumMonolith(MASTER_MONOLITH_DB[Math.floor(Math.random()*22)]); }, 2200); 
            });
        },
        disengageQuantum: function() { if(this.singletonInstance) this.singletonInstance.stop().then(()=>this.singletonInstance.clear()); document.getElementById('master-quantum-scanner-viewport').style.display='none'; },
        analyzeQuantumMonolith: function(p) {
            let g=p.g, reasons=[], f=State.user.filters;
            
            // TITAN QUANTUM LOGIC ENGINE V7 (MEDICAL VETO IMPLEMENTED)
            let veto = false;
            if(f.includes('m-diabetes') && (p.sugar > 10 || p.tags.includes('sug'))){ g='E'; reasons.push('×¡×•×›×¨ (MEDICAL VETO ×¡×•×›×¨×ª)'); veto=true; }
            if(f.includes('a-milk') && p.tags.includes('da')){ g='E'; reasons.push('××›×™×œ ×—×œ×‘ (×¡×›× ×ª ×—×™×™×)'); veto=true; }
            if(f.includes('a-gluten') && p.tags.includes('gl')){ g='E'; reasons.push('×’×œ×•×˜×Ÿ (×¡×›× ×ª ×—×™×™×)'); veto=true; }
            if(f.includes('m-celiac') && p.tags.includes('gl')){ g='E'; reasons.push('×’×œ×•×˜×Ÿ (MEDICAL VETO ×¦×œ×™××§)'); veto=true; }
            if(f.includes('m-pressure') && (p.salt > 500)){ g='E'; reasons.push('× ×ª×¨×Ÿ (MEDICAL VETO ×œ×—×¥ ×“×)'); veto=true; }

            // BIO-SYNC CONTEXTUAL LOGIC
            if(!veto && g!=='E') {
                if(State.ring==='stress' && p.sugar > 5) { g='D'; reasons.push('×¡×•×›×¨ ×’×‘×•×” (××’×‘×™×¨ ×¡×˜×¨×¡)'); }
                if(State.ring==='sick' && p.tags.includes('da')) { g='D'; reasons.push('×—×œ×‘ (××’×‘×™×¨ ×œ×™×—×” ×‘×—×•×œ×™)'); }
                if(State.ring==='sugar' && p.sugar > 10) { 
                    reasons.push('××¢×œ×” ×¡×•×›×¨ (××•××œ×¥ ×œ× ×¤×™×œ×”)');
                    if(g==='C') g='B'; else if(g==='B') g='B+'; else if(g==='B+') g='A';
                }
            }

            // QUALITY PREFERENCES LOGIC
            if(f.includes('q-green') && !p.tags.includes('green')){ if(!veto) g='D'; reasons.push('××™× ×• ×ª×• ×™×¨×•×§ ××•×¨×©×”'); }
            if(f.includes('q-aplus') && g!=='A+'){ if(!veto && g!=='E') g='D'; reasons.push('××™× ×• ×¢×•××“ ×‘×ª×§×Ÿ A+'); }
            if(f.includes('q-natural') && !p.tags.includes('natural')){ if(!veto && g!=='E') g='D'; reasons.push('××™× ×• 100% ×˜×‘×¢×™'); }

            State.temp = { ...p, g: g };
            
            // RENDER SUPREME RESULT UI
            const el = document.getElementById('res-titan-orb'); el.innerText=g; el.style.color=COLORS[g]; el.style.borderColor=COLORS[g];
            document.getElementById('res-monolith-name').innerText=p.n; document.getElementById('res-monolith-brand').innerText=p.b;
            
            // Market Simulation Engine
            const chains = [{n:'×¨××™ ×œ×•×™', p:0.92}, {n:'×©×•×¤×¨×¡×œ', p:1.15}, {n:'×™×•×—× × ×•×£', p:0.96}, {n:'×§×¨×¤×•×¨', p:1.08}];
            const baseP = 5.90 + Math.random()*25;
            document.getElementById('res-monolith-prices').innerHTML = chains.map(c => `
                <div style="background:rgba(255,255,255,0.06); padding:18px; border-radius:22px; display:flex; justify-content:space-between; align-items:center; border:1px solid rgba(255,255,255,0.1);">
                    <span style="font-weight:900; font-size:15px; color:#ddd;">${c.n}</span>
                    <span style="color:var(--g-a); font-weight:1000; font-size:18px;">â‚ª${(baseP * c.p).toFixed(2)}</span>
                </div>
            `).join('');

            document.getElementById('res-titan-report').innerHTML = reasons.length ? reasons.map(r=>`<div class="intelligence-report-line"><i class="fa-solid fa-triangle-exclamation" style="color:var(--g-e)"></i><span style="color:var(--g-e); font-weight:1000;">${r}</span></div>`).join('') : '<div style="color:var(--g-ap); font-weight:1000; font-size:22px;"><i class="fa-solid fa-shield-check"></i> ××•×¦×¨ ×××•××ª ×•×ª×§×™×Ÿ ×œ×—×œ×•×˜×™×Ÿ</div>';
            
            App.open('result');
        }
    };

    // --- HELPER CONSTANTS ---
    const COLORS = {'A+':'var(--g-ap)','A':'var(--g-a)','B+':'var(--g-bp)','B':'var(--g-b)','C':'var(--g-c)','D':'var(--g-d)','E':'var(--g-e)'};
    const SCORES = {'A+':100,'A':95,'B+':88,'B':78,'C':60,'D':40,'E':15};

    App.init();
</script>
</body>
</html>
