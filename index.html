<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <meta name="theme-color" content="#000000">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <title>Vibe OS BRUTE FORCE</title>
    
    <script src="https://unpkg.com/html5-qrcode" type="text/javascript"></script>
    
    <style>
        /* ================================================================
           1. CORE DESIGN SYSTEM 
           ================================================================ 
        */
        :root { 
            --bg-body: #030303;
            --bg-app: #000000;
            --surface: #141416;
            --surface-2: #1c1c1e;
            --border: #333;
            
            --plasma-1: #6366f1;
            --plasma-2: #d946ef;
            --plasma-3: #0ea5e9;
            
            --grade-a: #2ebb56; 
            --grade-b: #aadd00; 
            --grade-c: #ffcc00; 
            --grade-d: #ff9500; 
            --grade-e: #ff3b30;
            
            --cat-ethics: #10b981; 
            --cat-sensory: #f97316;
            --cat-quality: #06b6d4;
            
            --font: -apple-system, BlinkMacSystemFont, "SF Pro Display", Roboto, sans-serif;
            --max-w: 440px; 
        }

        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; outline: none; user-select: none; font-family: var(--font); }
        body { background: var(--bg-body); color: #fff; margin: 0; height: 100vh; display: flex; justify-content: center; align-items: center; overflow: hidden; }

        /* BOOT SCREEN */
        #boot-screen { position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: #000; z-index: 9999; display: flex; flex-direction: column; justify-content: center; align-items: center; transition: opacity 0.8s ease-out; }
        .boot-logo { font-size: 40px; font-weight: 900; letter-spacing: 4px; background: linear-gradient(135deg, var(--plasma-3), var(--plasma-1), var(--plasma-2)); -webkit-background-clip: text; -webkit-text-fill-color: transparent; animation: pulse 2s infinite; }
        .boot-loader { width: 120px; height: 4px; background: #333; margin-top: 20px; border-radius: 2px; overflow: hidden; }
        .boot-bar { width: 0%; height: 100%; background: var(--plasma-1); animation: load 2.5s cubic-bezier(0.2, 0.8, 0.2, 1) forwards; }
        @keyframes load { 0% {width:0%} 100% {width:100%} }

        /* MAIN FRAME */
        #app-frame { width: 100%; max-width: var(--max-w); height: 100%; max-height: 95vh; background: var(--bg-app); position: relative; border-radius: 48px; box-shadow: 0 0 0 14px #0a0a0a, 0 0 0 16px #1a1a1a, 0 20px 80px rgba(99, 102, 241, 0.15); overflow: hidden; display: flex; flex-direction: column; opacity: 0; transition: 0.5s; }
        #app-frame.loaded { opacity: 1; }
        @media (max-width: 480px) { body { align-items: flex-start; } #app-frame { max-width: 100%; height: 100vh; max-height: 100vh; border-radius: 0; box-shadow: none; border: none; } }

        #app-content { flex: 1; overflow-y: auto; padding-bottom: 140px; scrollbar-width: none; }
        
        /* UI COMPONENTS */
        .app-header { background: rgba(20, 20, 22, 0.96); backdrop-filter: blur(25px); position: sticky; top: 0; z-index: 100; border-bottom: 1px solid var(--border); padding: 16px 24px; display: flex; justify-content: space-between; align-items: center; }
        .logo-neo { font-size: 22px; font-weight: 900; font-style: italic; letter-spacing: 2px; background: linear-gradient(135deg, var(--plasma-3), var(--plasma-1), var(--plasma-2)); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }

        .profile-strip { display: flex; gap: 18px; overflow-x: auto; padding: 16px 24px; border-bottom: 1px solid rgba(255,255,255,0.03); }
        .p-av { width: 62px; height: 62px; border-radius: 22px; background: #2a2a2a; display: flex; align-items: center; justify-content: center; font-size: 26px; border: 2px solid transparent; }
        .p-unit.active .p-av { border-color: var(--plasma-1); box-shadow: 0 0 20px rgba(99, 102, 241, 0.3); }
        
        .dashboard { padding: 16px 24px; display: grid; grid-template-columns: 2fr 1fr; gap: 12px; }
        .card { background: var(--surface); border-radius: 24px; padding: 20px; border: 1px solid var(--border); position: relative; display: flex; flex-direction: column; justify-content: space-between; }
        .card.main { grid-column: span 2; background: linear-gradient(160deg, #242426, #0f0f10); border-left: 4px solid var(--plasma-1); flex-direction: row; align-items: center; }
        
        .scanner-trigger { margin: 10px 24px; height: 130px; background: #080808; border: 1px dashed #444; border-radius: 28px; display: flex; flex-direction: column; align-items: center; justify-content: center; cursor: pointer; color: #666; }
        
        .dock { position: absolute; bottom: 35px; left: 50%; transform: translateX(-50%); width: 88%; max-width: 380px; height: 75px; background: rgba(22,22,24,0.95); backdrop-filter: blur(30px); border-radius: 26px; border: 1px solid rgba(255,255,255,0.1); display: flex; justify-content: space-between; align-items: center; padding: 0 35px; z-index: 400; box-shadow: 0 20px 60px rgba(0,0,0,0.8); }
        .scan-fab { width: 68px; height: 68px; background: linear-gradient(135deg, var(--plasma-1), var(--plasma-3)); border-radius: 24px; display: flex; align-items: center; justify-content: center; font-size: 32px; margin-top: -55px; box-shadow: 0 10px 30px rgba(99, 102, 241, 0.5); cursor: pointer; color: #fff; border: 5px solid var(--bg-app); transform: rotate(45deg); }
        .scan-fab span { transform: rotate(-45deg); }

        .modal { position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.85); z-index: 500; display: none; align-items: flex-end; }
        .modal.open { display: flex; }
        .modal-sheet { width: 100%; background: #111; border-radius: 36px 36px 0 0; padding: 30px 24px; max-height: 92vh; overflow-y: auto; border-top: 1px solid var(--border); animation: slideUp 0.4s cubic-bezier(0.19, 1, 0.22, 1); padding-bottom: 120px; }
        @keyframes slideUp { from{transform:translateY(100%)} to{transform:translateY(0)} }

        /* Complex List Styles */
        .acc { background: var(--surface); border-radius: 16px; margin-bottom: 12px; overflow: hidden; border: 1px solid var(--border); }
        .acc-head { padding: 18px; font-weight: 700; display: flex; justify-content: space-between; cursor: pointer; font-size: 15px; }
        .acc-body { display: none; padding: 20px; background: #000; flex-wrap: wrap; gap: 8px; border-top: 1px solid var(--border); }
        .acc-body.open { display: flex; }
        .c-red .acc-head { border-right: 4px solid var(--grade-e); color: var(--grade-e); }
        .c-blue .acc-head { border-right: 4px solid var(--plasma-3); color: var(--plasma-3); }
        
        .chip { display: none; }
        .chip-lbl { padding: 10px 16px; background: #1a1a1a; border-radius: 10px; font-size: 13px; color: #888; cursor: pointer; border: 1px solid #333; font-weight: 600; display:flex; gap:6px; align-items:center; }
        .chip:checked + .chip-lbl { background: #eee; color: #000; }
        
        /* Result Styles */
        .grade-circle { width: 120px; height: 120px; border-radius: 50%; margin: 0 auto 20px auto; display: flex; align-items: center; justify-content: center; font-size: 60px; font-weight: 900; color: #000; box-shadow: 0 0 50px currentColor; }
        .alert-box { padding: 14px; background: rgba(255,255,255,0.03); border-radius: 12px; margin-bottom: 10px; font-size: 14px; border: 1px solid transparent; font-weight: 600; display: flex; align-items: center; gap: 10px; }
        
        /* Scanner */
        #cam-view { position: relative; width: 100%; height: 350px; background: #000; border-radius: 28px; overflow: hidden; margin-bottom: 20px; border: 1px solid #333; display: flex; align-items: center; justify-content: center; }
        .laser { position: absolute; top: 0; left: 0; width: 100%; height: 2px; background: var(--grade-e); box-shadow: 0 0 20px var(--grade-e); animation: scan 1.5s infinite; z-index: 10; }
        @keyframes scan { 0% {top:0%} 100% {top:100%} }
        
        /* Toast */
        #toast { position: absolute; top: 40px; left: 50%; transform: translateX(-50%) translateY(-100px); background: #222; color: #fff; padding: 12px 30px; border-radius: 50px; transition: 0.4s; z-index: 2000; font-weight: 600; border: 1px solid #333; white-space: nowrap; }
        #toast.show { transform: translateX(-50%) translateY(0); }
    </style>
</head>
<body>

<div id="boot-screen">
    <div class="boot-logo">VIBE OS</div>
    <div class="boot-loader"><div class="boot-bar"></div></div>
    <div class="boot-text">Initializing TITAN Core...</div>
</div>

<div id="app-frame">
    <div id="toast"></div>
    <div class="app-header">
        <div style="display:flex; align-items:center; gap:8px;">
            <span style="font-size:19px; font-weight:700; letter-spacing:1px;">VIBE</span>
            <span class="logo-neo">TITAN</span>
        </div>
    </div>

    <div class="profile-strip" id="p-strip"></div>

    <div id="app-content">
        <div class="dashboard">
            <div class="card main">
                <div style="flex:1;"><div style="font-size:11px; color:#888; font-weight:700; text-transform:uppercase; letter-spacing:1px;">×©×œ×•×,</div><div id="d-name" style="font-size:24px; font-weight:800; margin-top:2px;">×˜×•×¢×Ÿ...</div></div>
                <div style="width:44px; height:44px; border-radius:14px; background:rgba(255,255,255,0.05); display:flex; align-items:center; justify-content:center; border:1px solid #333; cursor:pointer;" onclick="openEdit(activeId)">âš™ï¸</div>
            </div>
            <div class="card" onclick="openRing()">
                <div style="font-size:11px; color:#888; font-weight:700; text-transform:uppercase;">×¡×˜×˜×•×¡ ×’×•×¤× ×™</div>
                <div id="d-status" style="font-size:30px; font-weight:800; margin-top:5px; letter-spacing:-0.5px; color:var(--grade-a);">×¨×’×™×œ</div>
            </div>
            <div class="card" onclick="openModal('cart')">
                <div style="font-size:11px; color:#888; font-weight:700; text-transform:uppercase;">×¡×œ ×§× ×™×•×ª</div>
                <div id="d-count" style="font-size:30px; font-weight:800; margin-top:5px; letter-spacing:-0.5px;">0</div>
            </div>
        </div>

        <div style="padding:8px 24px; display:flex; gap:10px;">
            <button onclick="quickAdd()" style="width:56px; background:var(--plasma-1); border:none; border-radius:18px; font-size:26px; color:#fff; cursor:pointer; display:flex; align-items:center; justify-content:center; box-shadow:0 0 20px rgba(99,102,241,0.3);">+</button>
            <input type="text" id="q-inp" placeholder="×”×•×¡×¤×” ×œ×‘×™×ª..." style="flex:1; background:var(--surface); border:1px solid var(--border); padding:16px; border-radius:18px; color:#fff; text-align:right; font-size:16px;">
        </div>

        <div id="d-prefs" style="padding:10px 24px 20px 24px; display:flex; flex-wrap:wrap; gap:8px;"></div>

        <div class="scanner-trigger" onclick="startScanner()">
            <div style="font-size:32px; margin-bottom:5px;">ğŸ“·</div>
            <div style="font-size:14px; font-weight:700; letter-spacing:1px; text-transform:uppercase; color:var(--plasma-3);">×¡×¨×™×§×ª ××•×¦×¨ (Real)</div>
        </div>
    </div>

    <div class="dock">
        <div onclick="openCart()" style="font-size:26px; cursor:pointer; color:#666; transition:0.2s;">ğŸ›’</div>
        <div class="scan-fab" onclick="startScanner()"><span>+</span></div>
        <div onclick="alert('×”×™×¡×˜×•×¨×™×”')" style="font-size:26px; cursor:pointer; color:#666; transition:0.2s;">ğŸ“œ</div>
    </div>

    <div id="modal-edit" class="modal"><div class="modal-sheet">
        <div class="m-header"><div style="font-size:24px; font-weight:800;">×¢×¨×™×›×ª ×¤×¨×•×¤×™×œ</div><div class="m-close" onclick="closeModal('edit')">âœ•</div></div>
        
        <div style="width:90px; height:90px; background:#222; border-radius:30px; margin:0 auto 20px auto; border:1px dashed #555; position:relative; overflow:hidden; cursor:pointer;" onclick="document.getElementById('file-inp').click()">
            <img id="preview-img" style="width:100%; height:100%; object-fit:cover; display:none;">
            <span id="cam-icon" style="position:absolute; top:50%; left:50%; transform:translate(-50%,-50%); font-size:24px; color:#666;">ğŸ“·</span>
        </div>
        <input type="file" id="file-inp" hidden onchange="handleImg(this)">
        <input type="text" id="edit-name" style="width:100%; padding:14px; background:var(--surface-2); border:1px solid var(--border); border-radius:12px; color:#fff; text-align:center; margin-bottom:20px;" placeholder="×©×">
        
        <div style="font-weight:700; margin-bottom:15px; color:#888; font-size:16px;">×”×’×“×¨×•×ª ×ª×–×•× ×”:</div>
        
        <div class="acc c-red"><div class="acc-head" onclick="tog(this)">âš ï¸ ××œ×¨×’×™×•×ª (×—×•×‘×”) <span>â–¼</span></div><div class="acc-body danger" id="sec-allergy">
            <div onclick="clearSec('sec-allergy')" style="width:100%; padding:10px; text-align:center; border:1px solid var(--plasma-1); color:var(--plasma-1); border-radius:10px; margin-bottom:10px; cursor:pointer; font-weight:700;">× ×§×” ×‘×—×™×¨×”</div>
            <input type="checkbox" id="a-milk" class="chip"><label for="a-milk" class="chip-lbl">ğŸ¥› ×—×œ×‘</label>
            <input type="checkbox" id="a-gluten" class="chip"><label for="a-gluten" class="chip-lbl">ğŸ ×’×œ×•×˜×Ÿ</label>
            <input type="checkbox" id="a-nuts" class="chip"><label for="a-nuts" class="chip-lbl">ğŸŒ° ××’×•×–×™×</label>
            <input type="checkbox" id="a-peanuts" class="chip"><label for="a-peanuts" class="chip-lbl">ğŸ¥œ ×‘×•×˜× ×™×</label>
            <input type="checkbox" id="a-sesame" class="chip"><label for="a-sesame" class="chip-lbl">ğŸ¥¯ ×©×•××©×•×</label>
            <input type="checkbox" id="a-soy" class="chip"><label for="a-soy" class="chip-lbl">ğŸ¥¢ ×¡×•×™×”</label>
            <input type="checkbox" id="a-eggs" class="chip"><label for="a-eggs" class="chip-lbl">ğŸ¥š ×‘×™×¦×™×</label>
            <input type="checkbox" id="a-fish" class="chip"><label for="a-fish" class="chip-lbl">ğŸŸ ×“×’×™×</label>
            <input type="checkbox" id="a-shell" class="chip"><label for="a-shell" class="chip-lbl">ğŸ¦ ×¤×™×¨×•×ª ×™×</label>
            <input type="checkbox" id="a-mustard" class="chip"><label for="a-mustard" class="chip-lbl">ğŸŒ­ ×—×¨×“×œ</label>
            <input type="checkbox" id="a-celery" class="chip"><label for="a-celery" class="chip-lbl">ğŸŒ¿ ×¡×œ×¨×™</label>
            <input type="checkbox" id="a-lupin" class="chip"><label for="a-lupin" class="chip-lbl">ğŸŒ¼ ×ª×•×¨××•×¡</label>
            <input type="checkbox" id="a-sulfites" class="chip"><label for="a-sulfites" class="chip-lbl">ğŸ· ×¡×•×œ×¤×™×˜×™×</label>
            <input type="checkbox" id="a-corn" class="chip"><label for="a-corn" class="chip-lbl">ğŸŒ½ ×ª×™×¨×¡</label>
        </div></div>

        <div class="acc c-red"><div class="acc-head" onclick="tog(this)">ğŸ¥ ×¨×¤×•××™ <span>â–¼</span></div><div class="acc-body danger">
            <input type="checkbox" id="d-diabetic" class="chip"><label for="d-diabetic" class="chip-lbl">ğŸ’‰ ×¡×•×›×¨×ª</label>
            <input type="checkbox" id="d-celiac" class="chip"><label for="d-celiac" class="chip-lbl">ğŸŒ¾ ×¦×œ×™××§</label>
            <input type="checkbox" id="d-heart" class="chip"><label for="d-heart" class="chip-lbl">ğŸ«€ ×œ×‘ (×©×•××Ÿ ×¨×•×•×™)</label>
            <input type="checkbox" id="d-salt" class="chip"><label for="d-salt" class="chip-lbl">ğŸ§‚ ×œ×—×¥ ×“×</label>
            <input type="checkbox" id="d-gout" class="chip"><label for="d-gout" class="chip-lbl">ğŸ¦¶ ×’××•×˜</label>
            <input type="checkbox" id="d-chol" class="chip"><label for="d-chol" class="chip-lbl">ğŸ” ×›×•×œ×¡×˜×¨×•×œ</label>
            <input type="checkbox" id="d-kidney" class="chip"><label for="d-kidney" class="chip-lbl">ğŸ©º ×›×œ×™×•×ª</label>
            <input type="checkbox" id="d-ibs" class="chip"><label for="d-ibs" class="chip-lbl">ğŸˆ ××¢×™ ×¨×’×™×–</label>
            <input type="checkbox" id="d-reflux" class="chip"><label for="d-reflux" class="chip-lbl">ğŸ”¥ ×¦×¨×‘×ª</label>
            <input type="checkbox" id="d-migraine" class="chip"><label for="d-migraine" class="chip-lbl">ğŸ§  ××™×’×¨× ×•×ª</label>
        </div></div>

        <div class="acc c-blue"><div class="acc-head" onclick="tog(this)">ğŸ¥— ×“×™××˜×” <span>â–¼</span></div><div class="acc-body">
            <input type="checkbox" id="l-vegan" class="chip"><label for="l-vegan" class="chip-lbl">ğŸŒ± ×˜×‘×¢×•× ×™</label>
            <input type="checkbox" id="l-veg" class="chip"><label for="l-veg" class="chip-lbl">ğŸ§€ ×¦××—×•× ×™</label>
            <input type="checkbox" id="l-keto" class="chip"><label for="l-keto" class="chip-lbl">ğŸ¥‘ ×§×˜×•</label>
            <input type="checkbox" id="l-paleo" class="chip"><label for="l-paleo" class="chip-lbl">ğŸ– ×¤×œ×™××•</label>
            <input type="checkbox" id="l-lowcarb" class="chip"><label for="l-lowcarb" class="chip-lbl">ğŸ“‰ ×“×œ ×¤×—××™××”</label>
            <input type="checkbox" id="l-organic" class="chip"><label for="l-organic" class="chip-lbl">ğŸ‚ ××•×¨×’× ×™</label>
            <input type="checkbox" id="l-clean" class="chip"><label for="l-clean" class="chip-lbl">ğŸ·ï¸ ×ª×•×•×™×ª × ×§×™×™×”</label>
            <input type="checkbox" id="l-fodmap" class="chip"><label for="l-fodmap" class="chip-lbl">ğŸ¥¦ FODMAP</label>
            <input type="checkbox" id="l-whole30" class="chip"><label for="l-whole30" class="chip-lbl">ğŸ¥— Whole30</label>
        </div></div>

        <div class="acc c-gold"><div class="acc-head" onclick="tog(this)">âœ¡ï¸ ×›×©×¨×•×ª <span>â–¼</span></div><div class="acc-body">
            <input type="checkbox" id="k-kosher" class="chip"><label for="k-kosher" class="chip-lbl">ğŸ“œ ×›×©×¨</label>
            <input type="checkbox" id="k-badatz" class="chip"><label for="k-badatz" class="chip-lbl">âœ¨ ×‘×“"×¥</label>
            <input type="checkbox" id="k-parve" class="chip"><label for="k-parve" class="chip-lbl">ğŸ ×¤×¨×•×•×”</label>
            <input type="checkbox" id="k-pass" class="chip"><label for="k-pass" class="chip-lbl">ğŸš« ×œ×¤×¡×—</label>
            <input type="checkbox" id="k-mehadrin" class="chip"><label for="k-mehadrin" class="chip-lbl">ğŸ• ××”×“×¨×™×Ÿ</label>
            <input type="checkbox" id="k-glatt" class="chip"><label for="k-glatt" class="chip-lbl">ğŸ¥© ×—×œ×§</label>
        </div></div>

        <div class="acc c-purple"><div class="acc-head" onclick="tog(this)">ğŸ§ª ×”×™×× ×¢×•×ª (E-Numbers) <span>â–¼</span></div><div class="acc-body danger">
            <input type="checkbox" id="x-sugar" class="chip"><label for="x-sugar" class="chip-lbl">ğŸ­ ×¡×•×›×¨</label>
            <input type="checkbox" id="x-proc" class="chip"><label for="x-proc" class="chip-lbl">ğŸ• ××¢×•×‘×“</label>
            <input type="checkbox" id="x-caff" class="chip"><label for="x-caff" class="chip-lbl">â˜• ×§×¤××™×Ÿ</label>
            <input type="checkbox" id="x-palm" class="chip"><label for="x-palm" class="chip-lbl">ğŸŒ´ ×©××Ÿ ×“×§×œ×™×</label>
            <input type="checkbox" id="x-msg" class="chip"><label for="x-msg" class="chip-lbl">ğŸ§‚ ××•× ×•×¡×•×“×™×•×</label>
            <input type="checkbox" id="x-trans" class="chip"><label for="x-trans" class="chip-lbl">ğŸŸ ×©×•××Ÿ ×˜×¨×× ×¡</label>
            <input type="checkbox" id="x-preserv" class="chip"><label for="x-preserv" class="chip-lbl">ğŸ¥« ××©××¨×™×</label>
            <input type="checkbox" id="x-color" class="chip"><label for="x-color" class="chip-lbl">ğŸ¨ ×¦×‘×¢ ×××›×œ</label>
            <input type="checkbox" id="x-sweet" class="chip"><label for="x-sweet" class="chip-lbl">ğŸ¬ ×××ª×™×§</label>
            <input type="checkbox" id="x-hfc" class="chip"><label for="x-hfc" class="chip-lbl">ğŸ¯ ×¡×™×¨×•×¤ ×ª×™×¨×¡</label>
        </div></div>

        <div class="acc c-green"><div class="acc-head" onclick="tog(this)">ğŸŒ ××ª×™×§×” ×•×¡×‘×™×‘×” <span>â–¼</span></div><div class="acc-body ethics">
            <input type="checkbox" id="e-fairtrade" class="chip"><label for="e-fairtrade" class="chip-lbl">ğŸ¤ ×¡×—×¨ ×”×•×’×Ÿ</label>
            <input type="checkbox" id="e-nopalm" class="chip"><label for="e-nopalm" class="chip-lbl">ğŸŒ´ ×œ×œ× ×“×§×œ×™×</label>
            <input type="checkbox" id="e-recycle" class="chip"><label for="e-recycle" class="chip-lbl">â™»ï¸ ××¨×™×–×” ××ª×›×œ×”</label>
            <input type="checkbox" id="e-local" class="chip"><label for="e-local" class="chip-lbl">ğŸ‡®ğŸ‡± ×ª×•×¦×¨×ª ×”××¨×¥</label>
            <input type="checkbox" id="e-gmo" class="chip"><label for="e-gmo" class="chip-lbl">ğŸ§¬ ×œ×œ× ×”× ×“×¡×”</label>
        </div></div>

        <div class="acc c-orange"><div class="acc-head" onclick="tog(this)">ğŸ‘¶ ××¨×§× ×•×—×•×©×™× <span>â–¼</span></div><div class="acc-body sensory">
            <input type="checkbox" id="s-soft" class="chip"><label for="s-soft" class="chip-lbl">â˜ï¸ ×¨×š</label>
            <input type="checkbox" id="s-crunch" class="chip"><label for="s-crunch" class="chip-lbl">ğŸ¥¨ ×§×¨×™×¡×¤×™</label>
            <input type="checkbox" id="s-liquid" class="chip"><label for="s-liquid" class="chip-lbl">ğŸ’§ × ×•×–×œ×™</label>
            <input type="checkbox" id="s-smooth" class="chip"><label for="s-smooth" class="chip-lbl">ğŸ® ×—×œ×§</label>
            <input type="checkbox" id="s-nospice" class="chip"><label for="s-nospice" class="chip-lbl">ğŸŒ¶ï¸ ×œ× ×—×¨×™×£</label>
        </div></div>

        <div class="acc c-teal"><div class="acc-head" onclick="tog(this)">ğŸ… ×“×™×¨×•×’ ×•××™×›×•×ª <span>â–¼</span></div><div class="acc-body quality">
            <input type="checkbox" id="q-nored" class="chip"><label for="q-nored" class="chip-lbl">ğŸš« ×œ×œ× ××“×‘×§×•×ª</label>
            <input type="checkbox" id="q-green" class="chip"><label for="q-green" class="chip-lbl">âœ… ×ª×• ×™×¨×•×§</label>
            <input type="checkbox" id="q-natural" class="chip"><label for="q-natural" class="chip-lbl">ğŸƒ 100% ×˜×‘×¢×™</label>
        </div></div>

        <button onclick="saveProfile()" style="width:100%; padding:18px; border-radius:18px; font-weight:700; font-size:16px; border:none; margin-top:10px; cursor:pointer; background:linear-gradient(90deg, var(--plasma-1), var(--plasma-3)); color:#fff; box-shadow:0 5px 20px rgba(99,102,241,0.3);">×©××•×¨ ×”×’×“×¨×•×ª</button>
        <button onclick="deleteProfile()" style="width:100%; padding:18px; border-radius:18px; font-weight:700; font-size:16px; margin-top:20px; cursor:pointer; background:rgba(255, 59, 48, 0.1); color:var(--grade-e); border:1px solid var(--grade-e);">××—×§ ×¤×¨×•×¤×™×œ</button>
        <div style="height:30px;"></div>
    </div></div>

    <div id="modal-cart" class="modal"><div class="modal-sheet"><div class="m-header"><div style="font-size:24px; font-weight:800;">×¢×’×œ×” ××©×•×ª×¤×ª</div><div class="m-close" onclick="closeModal('cart')">âœ•</div></div><div style="display:flex; gap:10px; margin-bottom:20px;"><button class="quick-btn" onclick="quickAddCart()">+</button><input type="text" id="c-inp" class="quick-inp" placeholder="×”×•×¡×¤×” ×œ×‘×™×ª..."></div><div id="cart-content" style="min-height:200px;"></div></div></div>

    <div id="modal-ring" class="modal"><div class="modal-sheet"><div class="m-header"><div class="m-title">××¦×‘ ×’×•×¤× ×™</div><div class="m-close" onclick="closeModal('ring')">âœ•</div></div><div style="display:grid; grid-template-columns:1fr 1fr; gap:12px;">
        <div onclick="setRing('normal')" style="padding:20px; background:var(--surface-2); border-radius:16px; text-align:center; font-weight:600;">ğŸŸ¢ ×¨×’×™×œ</div>
        <div onclick="setRing('stress')" style="padding:20px; background:var(--surface-2); border-radius:16px; text-align:center; font-weight:600;">ğŸ¤¯ ×¡×˜×¨×¡</div>
        <div onclick="setRing('sick')" style="padding:20px; background:var(--surface-2); border-radius:16px; text-align:center; font-weight:600;">ğŸ¤’ ×—×•×œ×™</div>
        <div onclick="setRing('cycle')" style="padding:20px; background:var(--surface-2); border-radius:16px; text-align:center; font-weight:600;">ğŸŒ¸ ××—×–×•×¨</div>
        <div onclick="setRing('sport')" style="padding:20px; background:var(--surface-2); border-radius:16px; text-align:center; font-weight:600;">ğŸ’ª ××™××•×Ÿ</div>
        <div onclick="setRing('sugar')" style="padding:20px; background:var(--surface-2); border-radius:16px; text-align:center; font-weight:600;">ğŸ©¸ × ×¤×™×œ×ª ×¡×•×›×¨</div>
        <div onclick="setRing('tired')" style="padding:20px; background:var(--surface-2); border-radius:16px; text-align:center; font-weight:600;">ğŸ˜´ ×¢×™×™×¤×•×ª</div>
        <div onclick="setRing('dehyd')" style="padding:20px; background:var(--surface-2); border-radius:16px; text-align:center; font-weight:600;">ğŸ’§ ×™×•×‘×©</div>
    </div></div></div>

    <div id="modal-res" class="modal"><div class="modal-sheet" style="text-align:center;">
        <div class="m-header"><div class="m-close" onclick="closeModal('res')">âœ•</div></div>
        <div style="font-size:13px; font-weight:700; margin-bottom:8px; text-transform:uppercase; letter-spacing:2px; color:#888;">×¦×™×•×Ÿ NEO</div>
        <div id="r-grade" style="width:120px; height:120px; border-radius:50%; margin:0 auto 20px auto; display:flex; align-items:center; justify-content:center; font-size:60px; font-weight:900; color:#000; box-shadow:0 0 50px currentColor;">A</div>
        <div id="r-name" style="font-size:26px; font-weight:800; margin-bottom:5px; padding:0 20px; line-height:1.2;">×©×</div>
        <div id="r-brand" style="font-size:14px; color:#888; margin-bottom:20px;">××•×ª×’</div>
        <div id="res-alert"></div>
        <div style="display:grid; grid-template-columns:1fr 1fr; gap:12px;">
            <button onclick="addToCart(true)" style="width:100%; padding:18px; border-radius:18px; font-weight:700; font-size:16px; border:none; background:linear-gradient(90deg, var(--plasma-1), var(--plasma-3)); color:#fff;">+ ×œ×‘×™×ª</button>
            <button onclick="addToCart(false)" style="width:100%; padding:18px; border-radius:18px; font-weight:700; font-size:16px; background:var(--surface-2); color:#fff; border:1px solid var(--border);">+ ×œ×™</button>
        </div>
    </div></div>

    <div id="modal-scan" class="modal"><div class="modal-sheet" style="height:95vh; padding:0; background:#000;">
        <div style="position:absolute; top:20px; left:20px; z-index:100; background:rgba(0,0,0,0.5); border-radius:50%; width:40px; height:40px; display:flex; align-items:center; justify-content:center; color:#fff; font-size:20px; cursor:pointer;" onclick="stopScanner()">âœ•</div>
        <div id="cam-view"><div id="reader" style="width:100%; height:100%;"></div><div class="laser"></div></div>
        <div style="position:absolute; bottom:40px; width:100%; display:flex; justify-content:center;"><button onclick="stopScanner()" style="background:rgba(255,59,48,0.2); border:1px solid var(--grade-e); color:var(--grade-e); padding:15px 40px; border-radius:30px; font-weight:700; backdrop-filter:blur(10px);">×‘×™×˜×•×œ ×—×–×¨×” ×œ×¨××©×™</button></div>
    </div></div>

</div>

<script>
    /* =========================================================================
       TITAN DATABASE: BRUTE FORCE EDITION
       Expanded JSON format for maximum line count and detail.
       =========================================================================
    */
    const DB = [
        // --- BAKERY & BREADS ---
        {
            n: '×œ×—× ××œ× ×× ×’\'×œ',
            g: 'A',
            gl: true,
            local: true,
            brand: '×× ×’\'×œ'
        },
        {
            n: '×œ×—× ××—×™×“ ×¤×¨×•×¡',
            g: 'C',
            gl: true,
            sug: true,
            local: true,
            brand: '×‘×¨××Ÿ'
        },
        {
            n: '×œ×—× ×›×•×¡××™×Ÿ ××œ×',
            g: 'A',
            gl: true,
            local: true,
            brand: '×”×××¤×”'
        },
        {
            n: '×œ×—× ×©×™×¤×•×Ÿ ××œ×',
            g: 'B',
            gl: true,
            local: true,
            brand: '×œ×—× ×”××¨×¥'
        },
        {
            n: '×—×œ×” ××ª×•×§×” ×œ×©×‘×ª',
            g: 'D',
            gl: true,
            sug: true,
            local: true,
            brand: '×“×’× ×™×ª'
        },
        {
            n: '×œ×—×× ×™×•×ª ×”××‘×•×¨×’×¨',
            g: 'C',
            gl: true,
            sug: true,
            brand: '×× ×’\'×œ'
        },
        {
            n: '×¤×™×ª×” ×¨×’×™×œ×”',
            g: 'C',
            gl: true,
            sug: true,
            brand: '×××¤×™×™×ª ××¨×™××œ'
        },
        {
            n: '×¤×™×ª×” ×›×•×¡××™×Ÿ',
            g: 'A',
            gl: true,
            brand: '×××¤×™×™×ª ××¨×™××œ'
        },
        {
            n: '×¤×™×ª×” ×§×œ×”',
            g: 'B',
            gl: true,
            brand: '×× ×’\'×œ'
        },
        {
            n: '×‘××’×˜ ×¦×¨×¤×ª×™',
            g: 'C',
            gl: true,
            brand: '×‘×•× ×–\'×•×¨'
        },
        {
            n: '×˜×•×¨×˜×™×™×” ××§×¡×™×§× ×™×ª',
            g: 'C',
            gl: true,
            proc: true,
            brand: '×¨××™ ×œ×•×™'
        },
        {
            n: '×¤×¨×™×›×™×•×ª ××•×¨×–',
            g: 'B',
            soft: false,
            brand: '×× ×¨×’\'×™'
        },
        {
            n: '×¤×¨×™×›×™×•×ª ×›×•×¡××ª',
            g: 'A',
            soft: false,
            brand: 'B&D'
        },
        {
            n: '×§×¨×§×¨ ×–×”×‘',
            g: 'D',
            gl: true,
            sug: true,
            proc: true,
            brand: '××¡×'
        },
        {
            n: '×¤×ª×™×ª',
            g: 'C',
            gl: true,
            brand: '×™×•× ×™×œ×™×•×•×¨'
        },
        {
            n: '×œ×—××™×ª',
            g: 'B',
            gl: true,
            brand: '××¡×'
        },
        {
            n: '×‘×™×¡×§×•×•×™×˜×™× ×¤×ª×™ ×‘×¨',
            g: 'D',
            gl: true,
            sug: true,
            soft: false,
            brand: '×¢×œ×™×ª'
        },
        {
            n: '×¢×•×’×ª ×”×‘×™×ª ×©×•×§×•×œ×“',
            g: 'E',
            gl: true,
            sug: true,
            da: true,
            proc: true,
            brand: '××¡×'
        },
        {
            n: '×¢×•×’×ª ×’×‘×™× ×” ×¤×™×¨×•×¨×™×',
            g: 'E',
            gl: true,
            sug: true,
            da: true,
            brand: '×¢×œ×™×ª'
        },
        {
            n: '×¨×•×’×œ×š ×©×•×§×•×œ×“',
            g: 'E',
            gl: true,
            sug: true,
            da: true,
            brand: '××—×•×”'
        },
        {
            n: '×‘×•×¨×§×¡ ×ª×¤×•"×',
            g: 'E',
            gl: true,
            proc: true,
            brand: '××¢×“× ×•×ª'
        },
        {
            n: '×’\'×—× ×•×Ÿ ×§×¤×•×',
            g: 'E',
            gl: true,
            proc: true,
            brand: '×©×œ×•×©×ª ×”××•×¤×™×'
        },
        {
            n: '××œ××•×•×—',
            g: 'E',
            gl: true,
            proc: true,
            brand: '××¢×“× ×•×ª'
        },
        {
            n: '×§××— ×œ×‘×Ÿ',
            g: 'C',
            gl: true,
            brand: '×”× ××œ'
        },
        {
            n: '×§××— ××œ×',
            g: 'A',
            gl: true,
            brand: '×”× ××œ'
        },
        {
            n: '×¤×™×¨×•×¨×™ ×œ×—×',
            g: 'C',
            gl: true,
            brand: '×××¡×˜×¨ ×©×£'
        },

        // --- DAIRY ---
        {
            n: '×—×œ×‘ 3% ×ª× ×•×‘×”',
            g: 'B',
            da: true,
            local: true,
            liquid: true,
            brand: '×ª× ×•×‘×”'
        },
        {
            n: '×—×œ×‘ 1% ×˜×¨×”',
            g: 'B',
            da: true,
            local: true,
            liquid: true,
            brand: '×˜×¨×”'
        },
        {
            n: '×—×œ×‘ ××•×¢×©×¨ ×¡×™×“×Ÿ',
            g: 'B',
            da: true,
            local: true,
            brand: '×ª× ×•×‘×”'
        },
        {
            n: '×—×œ×‘ ×¡×•×™×” ×œ×œ× ×¡×•×›×¨',
            g: 'A',
            soy: true,
            liquid: true,
            ethics: true,
            brand: '×ª× ×•×‘×” ××œ×˜×¨× ×˜×™×‘'
        },
        {
            n: '×—×œ×‘ ×©×§×“×™×',
            g: 'B',
            nut: true,
            liquid: true,
            brand: '××œ×¤×¨×•'
        },
        {
            n: '×—×œ×‘ ×©×™×‘×•×œ×ª ×©×•×¢×œ',
            g: 'B',
            gl: true,
            liquid: true,
            brand: 'Vitariz'
        },
        {
            n: '×©×•×§×• ×™×˜×‘×ª×”',
            g: 'E',
            da: true,
            sug: true,
            liquid: true,
            brand: '×™×˜×‘×ª×”'
        },
        {
            n: '×§×•×˜×’\' 5%',
            g: 'A',
            da: true,
            local: true,
            soft: true,
            brand: '×ª× ×•×‘×”'
        },
        {
            n: '×§×•×˜×’\' 9%',
            g: 'B',
            da: true,
            local: true,
            brand: '×˜×¨×”'
        },
        {
            n: '×’×‘×™× ×” ×œ×‘× ×” 5%',
            g: 'A',
            da: true,
            local: true,
            smooth: true,
            brand: '×¡×§×™'
        },
        {
            n: '×’×‘×™× ×” ×œ×‘× ×” 9%',
            g: 'B',
            da: true,
            local: true,
            brand: '×ª× ×•×‘×”'
        },
        {
            n: '×’×‘×™× ×” ×¦×”×•×‘×” ×¢××§',
            g: 'D',
            da: true,
            proc: true,
            brand: '×ª× ×•×‘×”'
        },
        {
            n: '×’×‘×™× ×” ×¦×”×•×‘×” 9%',
            g: 'C',
            da: true,
            proc: true,
            brand: '× ×¢×'
        },
        {
            n: '××•×¦×¨×œ×”',
            g: 'C',
            da: true,
            brand: '×’×“'
        },
        {
            n: '×¤×¨××–×Ÿ',
            g: 'C',
            da: true,
            salt: true,
            brand: '×’×“'
        },
        {
            n: '×‘×•×œ×’×¨×™×ª 5%',
            g: 'A',
            da: true,
            brand: '×¤×™×¨××•×¡'
        },
        {
            n: '×’×‘×™× ×ª ×¤×˜×” ×¢×™×–×™×',
            g: 'B',
            da: true,
            brand: '××©×§ ×¦×•×¨×™××œ'
        },
        {
            n: '×œ××‘× ×” ×‘×©××Ÿ ×–×™×ª',
            g: 'B',
            da: true,
            brand: '×¤×™×¨××•×¡'
        },
        {
            n: '×©×× ×ª ××ª×•×§×”',
            g: 'D',
            da: true,
            brand: '×™×˜×‘×ª×”'
        },
        {
            n: '×©×× ×ª ×œ×‘×™×©×•×œ 15%',
            g: 'C',
            da: true,
            brand: '×ª× ×•×‘×”'
        },
        {
            n: '×™×•×’×•×¨×˜ ××•×œ×¨ ×ª×•×ª',
            g: 'C',
            da: true,
            sug: true,
            brand: '××•×œ×¨'
        },
        {
            n: '×™×•×’×•×¨×˜ BIO ×œ×‘×Ÿ',
            g: 'A',
            da: true,
            smooth: true,
            brand: '×“× ×•× ×”'
        },
        {
            n: '×™×•×’×•×¨×˜ ×“× ×•× ×”',
            g: 'B',
            da: true,
            brand: '×“× ×•× ×”'
        },
        {
            n: '××§×˜×™××œ ×ª×•×ª',
            g: 'C',
            da: true,
            sug: true,
            brand: '×“× ×•× ×”'
        },
        {
            n: '××™×œ×§×™ ×©×•×§×•×œ×“',
            g: 'E',
            da: true,
            sug: true,
            smooth: true,
            brand: '×©×˜×¨××•×¡'
        },
        {
            n: '×“× ×™ ×©×•×§×•×œ×“',
            g: 'E',
            da: true,
            sug: true,
            brand: '×©×˜×¨××•×¡'
        },
        {
            n: '×’××“×™× ×ª×•×ª',
            g: 'C',
            da: true,
            sug: true,
            baby: true,
            brand: '×©×˜×¨××•×¡'
        },
        {
            n: '××¢×“×Ÿ ×¡×•×™×” ×©×•×§×•×œ×“',
            g: 'B',
            soy: true,
            sug: true,
            brand: '×ª× ×•×‘×”'
        },
        {
            n: '×—×××” ×¦×”×•×‘×”',
            g: 'C',
            da: true,
            brand: '×ª× ×•×‘×”'
        },
        {
            n: '××¨×’×¨×™× ×” ×‘×˜×¢× ×—×××”',
            g: 'E',
            trans: true,
            proc: true,
            brand: '×‘×œ×•×‘× ×“'
        },

        // --- SNACKS ---
        {
            n: '×‘××‘×” ××¡×',
            g: 'C',
            nut: true,
            soft: true,
            brand: '××¡×'
        },
        {
            n: '×‘××‘×” × ×•×’×˜',
            g: 'D',
            nut: true,
            sug: true,
            brand: '××¡×'
        },
        {
            n: '×‘×™×¡×œ×™ ×’×¨×™×œ',
            g: 'E',
            gl: true,
            proc: true,
            crunch: true,
            brand: '××¡×'
        },
        {
            n: '×‘×™×¡×œ×™ ×‘×¦×œ',
            g: 'E',
            gl: true,
            proc: true,
            brand: '××¡×'
        },
        {
            n: '×ª×¤×•×¦\'×™×¤×¡ ×˜×‘×¢×™',
            g: 'D',
            proc: true,
            brand: '×¢×œ×™×ª'
        },
        {
            n: '×ª×¤×•×¦\'×™×¤×¡ ×©×× ×ª ×‘×¦×œ',
            g: 'E',
            da: true,
            proc: true,
            brand: '×¢×œ×™×ª'
        },
        {
            n: '×“×•×¨×™×˜×•×¡ ×—××•×¥ ×—×¨×™×£',
            g: 'D',
            gl: true,
            spice: true,
            brand: '×¢×œ×™×ª'
        },
        {
            n: '×‘×™×™×’×œ×” ×©××™× ×™×•×ª',
            g: 'C',
            gl: true,
            salt: true,
            brand: '×‘×™×™×’×œ ×‘×™×™×’×œ'
        },
        {
            n: '×‘×™×™×’×œ×” ×©×˜×•×—×™×',
            g: 'C',
            gl: true,
            brand: '×‘×™×™×’×œ ×‘×™×™×’×œ'
        },
        {
            n: '×¤×•×¤×§×•×¨×Ÿ ×œ××™×§×¨×•',
            g: 'D',
            proc: true,
            brand: '×”×•×˜×¤×•×¤'
        },
        {
            n: '×©×•×§×•×œ×“ ×¤×¨×”',
            g: 'E',
            da: true,
            sug: true,
            brand: '×¢×œ×™×ª'
        },
        {
            n: '×©×•×§×•×œ×“ ××¨×™×¨ 70%',
            g: 'B',
            sug: true,
            brand: '×¢×œ×™×ª'
        },
        {
            n: '×¤×¡×§ ×–××Ÿ',
            g: 'E',
            gl: true,
            da: true,
            sug: true,
            brand: '×¢×œ×™×ª'
        },
        {
            n: '×›×™×£ ×›×£',
            g: 'E',
            gl: true,
            da: true,
            sug: true,
            brand: '×¢×œ×™×ª'
        },
        {
            n: '××§×•×¤×œ×ª',
            g: 'E',
            da: true,
            sug: true,
            brand: '×¢×œ×™×ª'
        },
        {
            n: '×˜×•×•×™×¡×˜',
            g: 'E',
            gl: true,
            da: true,
            sug: true,
            brand: '×¢×œ×™×ª'
        },
        {
            n: '×¡×•×›×¨×™×” ×¢×œ ××§×œ',
            g: 'E',
            sug: true,
            color: true,
            brand: '×›×¨××™×ª'
        },
        {
            n: '××¡×˜×™×§ ×‘×–×•×§×”',
            g: 'E',
            sug: true,
            color: true,
            brand: '×¢×œ×™×ª'
        },
        {
            n: '×—×œ×•×•×”',
            g: 'D',
            ses: true,
            sug: true,
            brand: '××—×•×”'
        },
        {
            n: '×•×•×¤×œ×™× ×œ×™××•×Ÿ',
            g: 'E',
            gl: true,
            sug: true,
            trans: true,
            brand: '××Ÿ'
        },
        {
            n: '×¢×•×’×™×•×ª ××•×¨××•',
            g: 'E',
            gl: true,
            sug: true,
            brand: '× ×‘×™×¡×§×•'
        },
        {
            n: '×¢×•×’×™×•×ª ×œ×•×˜×•×¡',
            g: 'E',
            gl: true,
            sug: true,
            brand: '×œ×•×˜×•×¡'
        },
        {
            n: '×‘×¤×œ×•×ª ×©×•×§×•×œ×“',
            g: 'E',
            gl: true,
            sug: true,
            brand: '×¢×œ×™×ª'
        },
        {
            n: '×¢×¨×’×œ×™×•×ª ×ª×•×ª',
            g: 'E',
            gl: true,
            sug: true,
            brand: '××¡×'
        },
        {
            n: '×“×•×‘×•× ×™×',
            g: 'D',
            proc: true,
            brand: '××¡×'
        },
        {
            n: '××¤×¨×•×¤×•',
            g: 'D',
            gl: true,
            brand: '××¡×'
        },
        {
            n: '×¦\'×™×˜×•×¡ ×’×‘×™× ×”',
            g: 'E',
            da: true,
            color: true,
            brand: '×¢×œ×™×ª'
        },

        // --- DRINKS ---
        {
            n: '×§×•×§×” ×§×•×œ×”',
            g: 'E',
            sug: true,
            caff: true,
            brand: '×§×•×§×” ×§×•×œ×”'
        },
        {
            n: '×§×•×œ×” ×–×™×¨×•',
            g: 'D',
            caff: true,
            sweet: true,
            brand: '×§×•×§×” ×§×•×œ×”'
        },
        {
            n: '×¡×¤×¨×™×™×˜',
            g: 'E',
            sug: true,
            brand: '×¡×¤×¨×™×™×˜'
        },
        {
            n: '×¡×¤×¨×™×™×˜ ×–×™×¨×•',
            g: 'D',
            sweet: true,
            brand: '×¡×¤×¨×™×™×˜'
        },
        {
            n: '×¤×× ×˜×”',
            g: 'E',
            sug: true,
            color: true,
            brand: '×¤×× ×˜×”'
        },
        {
            n: '× ×‘×™×¢×•×ª ×‘×˜×¢××™×',
            g: 'C',
            sug: true,
            brand: '× ×‘×™×¢×•×ª'
        },
        {
            n: '××™× ×‘×˜×¢× ×ª×¤×•×—',
            g: 'C',
            sug: true,
            brand: '××™ ×¢×“×Ÿ'
        },
        {
            n: '××™× ××™× ×¨×œ×™×',
            g: 'A',
            liquid: true,
            brand: '××™ ×¢×“×Ÿ'
        },
        {
            n: '×¡×•×“×”',
            g: 'A',
            liquid: true,
            brand: '×©×•×•×¤×¡'
        },
        {
            n: '××™×¥ ×ª×¤×•×–×™× ×¡×—×•×˜',
            g: 'B',
            sug: true,
            liquid: true,
            brand: '×¤×¨×™×’×ª'
        },
        {
            n: '××™×¥ ×¢× ×‘×™× ×ª×™×¨×•×©',
            g: 'D',
            sug: true,
            brand: '×›×¨××œ'
        },
        {
            n: '× ×§×˜×¨ ×× ×’×•',
            g: 'D',
            sug: true,
            brand: '×¡×¤×¨×™× ×’'
        },
        {
            n: '××™×™×¡ ×ª×” ××¤×¨×¡×§',
            g: 'E',
            sug: true,
            brand: '×¤×™×•×– ×˜×™'
        },
        {
            n: '×‘×™×¨×” ×’×•×œ×“×¡×˜××¨',
            g: 'D',
            gl: true,
            sug: true,
            brand: '×’×•×œ×“×¡×˜××¨'
        },
        {
            n: '×‘×™×¨×” ×”×™×™× ×§×Ÿ',
            g: 'D',
            gl: true,
            brand: '×”×™×™× ×§×Ÿ'
        },
        {
            n: '×™×™×Ÿ ××“×•× ×™×‘×©',
            g: 'C',
            brand: '×‘×¨×§×Ÿ'
        },
        {
            n: '×™×™×Ÿ ×œ×‘×Ÿ ×—×¦×™ ×™×‘×©',
            g: 'C',
            sug: true,
            brand: '×’×•×œ×Ÿ'
        },
        {
            n: '×•×•×“×§×” ××‘×¡×•×œ×•×˜',
            g: 'D',
            brand: '××‘×¡×•×œ×•×˜'
        },
        {
            n: '×•×•×™×¡×§×™ ×’\'×™×™××¡×•×Ÿ',
            g: 'D',
            brand: '×’\'×™×™××¡×•×Ÿ'
        },
        {
            n: '×¢×¨×§',
            g: 'D',
            brand: '×¢×œ×™×ª ×”×¢×¨××§'
        },
        {
            n: '×§×¤×” × ××¡ ×¢×œ×™×ª',
            g: 'B',
            caff: true,
            brand: '×¢×œ×™×ª'
        },
        {
            n: '×§×¤×” ×©×—×•×¨ ×˜×•×¨×§×™',
            g: 'A',
            caff: true,
            brand: '×¢×œ×™×ª'
        },
        {
            n: '×§×¤×” × ××¡ ××’×•×¨×¢×Ÿ',
            g: 'B',
            caff: true,
            brand: '×˜×™×™×¡×˜×¨×¡ ×¦\'×•×™×¡'
        },
        {
            n: '×§×¤×¡×•×œ×•×ª ×§×¤×”',
            g: 'A',
            caff: true,
            brand: '× ×¡×¤×¨×¡×•'
        },
        {
            n: '×ª×” ×™×¨×•×§',
            g: 'A',
            brand: '×•×™×¡×•×¦×§×™'
        },
        {
            n: '×ª×” ×•×™×¡×•×¦×§×™ ×¨×’×™×œ',
            g: 'A',
            brand: '×•×™×¡×•×¦×§×™'
        },
        {
            n: '×ª×” ×§××•××™×œ',
            g: 'A',
            brand: '×¤×•××¤×“×•×¨'
        },
        {
            n: '××©×§×” ×× ×¨×’×™×” XL',
            g: 'E',
            sug: true,
            caff: true,
            brand: 'XL'
        },
        {
            n: '××©×§×” ×× ×¨×’×™×” BLU',
            g: 'E',
            sug: true,
            caff: true,
            brand: 'BLU'
        },

        // --- FROZEN ---
        {
            n: '×¤×™×¦×” ××¢×“× ×•×ª',
            g: 'E',
            gl: true,
            da: true,
            proc: true,
            brand: '××¢×“× ×•×ª'
        },
        {
            n: '×©× ×™×¦×œ ×ª×™×¨×¡ ×˜×‘×¢×•×œ',
            g: 'C',
            gl: true,
            proc: true,
            brand: '×˜×‘×¢×•×œ'
        },
        {
            n: '×©× ×™×¦×œ ×¢×•×£ ×××™×ª×™',
            g: 'C',
            gl: true,
            proc: true,
            brand: '×××× ×¢×•×£'
        },
        {
            n: '× ×§× ×™×§×™×•×ª ×¢×•×£',
            g: 'E',
            proc: true,
            nitrites: true,
            brand: '×–×•×’×œ×•×‘×§'
        },
        {
            n: '×”××‘×•×¨×’×¨ ×§×¤×•×',
            g: 'D',
            proc: true,
            brand: '×˜×™×‘×•×Ÿ ×•×™×œ'
        },
        {
            n: '×§×‘×‘ ××–×¨×—×™',
            g: 'D',
            proc: true,
            brand: '×‘×œ×“×™'
        },
        {
            n: '×‘×•×¨×§×¡ ×’×‘×™× ×”',
            g: 'E',
            gl: true,
            da: true,
            brand: '××¢×“× ×•×ª'
        },
        {
            n: '××¤×•× ×” ×§×¤×•××”',
            g: 'A',
            brand: '×¡× ×¤×¨×•×¡×˜'
        },
        {
            n: '×©×¢×•×¢×™×ª ×™×¨×•×§×” ×§×¤×•××”',
            g: 'A',
            brand: '×¡× ×¤×¨×•×¡×˜'
        },
        {
            n: '×‘×¨×•×§×•×œ×™ ×§×¤×•×',
            g: 'A',
            brand: '×¡× ×¤×¨×•×¡×˜'
        },
        {
            n: '×œ×§×˜ ×™×¨×§×•×ª',
            g: 'A',
            brand: '×¡× ×¤×¨×•×¡×˜'
        },
        {
            n: '×¦\'×™×¤×¡ ×§×¤×•× ×œ×ª× ×•×¨',
            g: 'C',
            proc: true,
            brand: '×ª×¤×•×’×Ÿ'
        },
        {
            n: '×’×œ×™×“×” ×•× ×™×œ ××©×¤×—×ª×™×ª',
            g: 'E',
            da: true,
            sug: true,
            brand: '×§×¨××™×¡×™××•'
        },
        {
            n: '×’×œ×™×“×” ×¤×¨×•×•×”',
            g: 'E',
            sug: true,
            proc: true,
            brand: '×¨×™××•'
        },
        {
            n: '××¨×˜×™×§ ×§×¨×—',
            g: 'D',
            sug: true,
            color: true,
            brand: '× ×¡×˜×œ×”'
        },
        {
            n: '××’× ×•× ×©×•×§×•×œ×“',
            g: 'E',
            da: true,
            sug: true,
            brand: '×©×˜×¨××•×¡'
        },

        // --- FRESH ---
        {
            n: '×¢×’×‘× ×™×”',
            g: 'A',
            brand: '×”×©×“×”'
        },
        {
            n: '××œ×¤×¤×•×Ÿ',
            g: 'A',
            brand: '×”×©×“×”'
        },
        {
            n: '×¤×œ×¤×œ ××“×•×',
            g: 'A',
            brand: '×”×©×“×”'
        },
        {
            n: '×’×–×¨',
            g: 'A',
            crunch: true,
            brand: '×“×•×“ ××©×”'
        },
        {
            n: '×—×¡×” ×¢×¨×‘×™×ª',
            g: 'A',
            brand: '×¢×œ×™ ×§×˜×™×£'
        },
        {
            n: '×‘×¦×œ ×œ×‘×Ÿ',
            g: 'A',
            brand: '×©×•×§'
        },
        {
            n: '×ª×¤×•×— ××“××”',
            g: 'B',
            brand: '×“×•×“ ××©×”'
        },
        {
            n: '×‘×˜×˜×”',
            g: 'A',
            brand: '×©×•×§'
        },
        {
            n: '×›×¨×•×‘ ×œ×‘×Ÿ',
            g: 'A',
            brand: '×©×•×§'
        },
        {
            n: '×›×¨×•×‘×™×ª',
            g: 'A',
            brand: '×©×•×§'
        },
        {
            n: '×§×™×©×•×',
            g: 'A',
            brand: '×©×•×§'
        },
        {
            n: '×—×¦×™×œ',
            g: 'A',
            brand: '×©×•×§'
        },
        {
            n: '×“×œ×¢×ª',
            g: 'A',
            brand: '×©×•×§'
        },
        {
            n: '×¤×˜×¨×™×•×ª ×©××¤×™× ×™×•×Ÿ',
            g: 'A',
            brand: '××¨×™× ×”'
        },
        {
            n: '×ª×¤×•×— ×¢×¥ ×—×¨××•×Ÿ',
            g: 'A',
            crunch: true,
            brand: '×‘×¨××©×™×ª'
        },
        {
            n: '×‘× × ×”',
            g: 'B',
            sug: true,
            soft: true,
            brand: '×‘× × ×•×ª ×”×—×•×£'
        },
        {
            n: '×ª×¤×•×–',
            g: 'A',
            sug: true,
            brand: '×¤×¨×™ ×”×“×¨'
        },
        {
            n: '×§×œ×× ×˜×™× ×”',
            g: 'A',
            sug: true,
            brand: '×¤×¨×™ ×”×“×¨'
        },
        {
            n: '××‘×˜×™×—',
            g: 'B',
            sug: true,
            brand: '×©×•×§'
        },
        {
            n: '××œ×•×Ÿ',
            g: 'B',
            sug: true,
            brand: '×©×•×§'
        },
        {
            n: '×¢× ×‘×™× ×™×¨×•×§×™×',
            g: 'C',
            sug: true,
            brand: '×˜×œ×™'
        },
        {
            n: '××‘×•×§×“×•',
            g: 'A',
            brand: '×—×§×œ××™ ×’×¨× ×•×ª'
        },
        {
            n: '×œ×™××•×Ÿ',
            g: 'A',
            brand: '×©×•×§'
        },
        {
            n: '×©×•×',
            g: 'A',
            brand: '×©×•×§'
        },
        {
            n: '×¤×˜×¨×•×–×™×œ×™×”',
            g: 'A',
            brand: '×¢×œ×™ ×§×˜×™×£'
        },
        {
            n: '×›×•×¡×‘×¨×”',
            g: 'A',
            brand: '×¢×œ×™ ×§×˜×™×£'
        },
        {
            n: '×©××™×¨',
            g: 'A',
            brand: '×¢×œ×™ ×§×˜×™×£'
        },
        {
            n: '× ×¢× ×¢',
            g: 'A',
            brand: '×¢×œ×™ ×§×˜×™×£'
        },
        {
            n: '×‘×–×™×œ×™×§×•×',
            g: 'A',
            brand: '×¢×œ×™ ×§×˜×™×£'
        },
        {
            n: '××’×¡',
            g: 'A',
            sug: true,
            brand: '×‘×¨××©×™×ª'
        },
        {
            n: '××¤×¨×¡×§',
            g: 'B',
            sug: true,
            brand: '×‘×¨××©×™×ª'
        },
        {
            n: '×©×–×™×£',
            g: 'B',
            sug: true,
            brand: '×‘×¨××©×™×ª'
        },
        {
            n: '×ª×•×ª ×©×“×”',
            g: 'A',
            brand: '×©×•×§'
        },
        {
            n: '×“×•×‘×“×‘× ×™×',
            g: 'B',
            sug: true,
            brand: '×‘×¨××©×™×ª'
        },

        // --- MEAT ---
        {
            n: '×—×–×” ×¢×•×£ ×˜×¨×™',
            g: 'A',
            brand: '×¢×•×£ ×˜×•×‘'
        },
        {
            n: '×›×¨×¢×™×™× ×¢×•×£',
            g: 'B',
            brand: '×ª× ×•×‘×”'
        },
        {
            n: '×‘×©×¨ ×˜×—×•×Ÿ ×˜×¨×™',
            g: 'B',
            brand: '××“×•× ××“×•×'
        },
        {
            n: '×¡×˜×™×™×§ ×× ×˜×¨×™×§×•×˜',
            g: 'C',
            heart: true,
            brand: '××“×•× ××“×•×'
        },
        {
            n: '×“×’ ×¡×œ××•×Ÿ ×˜×¨×™',
            g: 'A',
            fish: true,
            brand: '×“×’×•×Ÿ'
        },
        {
            n: '×“×’ ××× ×•×Ÿ ×˜×¨×™',
            g: 'A',
            fish: true,
            brand: '×“×’×•×Ÿ'
        },
        {
            n: '×“×’ ×“× ×™×¡',
            g: 'A',
            fish: true,
            brand: '×“×’×•×Ÿ'
        },
        {
            n: '×‘×™×¦×™× L',
            g: 'A',
            eggs: true,
            brand: '×ª× ×•×‘×”'
        }
    ];

    // --- 2. APP STATE ---
    let users = JSON.parse(localStorage.getItem('vTitan_ultra_users')) || [{id:1, name:'×× ×™', img:null, status:'normal', filters:[], pList:[]}];
    let cart = JSON.parse(localStorage.getItem('vTitan_ultra_cart')) || [];
    let activeId = users[0].id;
    let html5QrcodeScanner = null;

    const STATES = {
        'normal':{t:'×¨×’×™×œ',c:'var(--grade-a)'}, 
        'stress':{t:'×¡×˜×¨×¡',c:'var(--grade-e)'}, 
        'sick':{t:'×—×•×œ×™',c:'var(--plasma-2)'}, 
        'cycle':{t:'××—×–×•×¨',c:'var(--plasma-2)'}, 
        'sport':{t:'××™××•×Ÿ',c:'var(--plasma-3)'}, 
        'sugar':{t:'×¡×•×›×¨',c:'var(--grade-d)'},
        'tired':{t:'×¢×™×™×¤×•×ª',c:'var(--grade-c)'}, 
        'dehyd':{t:'×™×•×‘×©',c:'var(--plasma-3)'}
    };

    // --- 3. BOOT SEQUENCE ---
    window.onload = () => {
        setTimeout(() => {
            document.getElementById('boot-screen').style.opacity = 0;
            document.getElementById('app-frame').classList.add('loaded');
            setTimeout(() => document.getElementById('boot-screen').style.display = 'none', 800);
        }, 2000);
        render(); update();
    };

    // --- 4. RENDER LOGIC ---
    function render() {
        const s = document.getElementById('p-strip');
        let h = '';
        users.forEach(u => {
            const act = u.id===activeId ? 'active' : '';
            const img = u.img ? `<img src="${u.img}">` : `<span>${u.name[0]}</span>`;
            const col = STATES[u.status].c.replace('var(','').replace(')','');
            h += `<div class="p-unit ${act}" onclick="switchUser(${u.id})">
                    <div class="p-av">
                        ${img}
                        <div style="position:absolute; bottom:0; right:0; width:14px; height:14px; background:${act?'var(--plasma-1)':'#333'}; border-radius:50%; border:2px solid #000;"></div>
                        <div style="position:absolute; top:0; left:0; width:100%; height:100%; display:flex; align-items:center; justify-content:center; background:rgba(0,0,0,0.5); opacity:0; transition:0.2s;" onclick="event.stopPropagation(); openEdit(${u.id})">âœ</div>
                    </div>
                    <span style="font-size:11px; margin-top:5px;">${u.name}</span>
                  </div>`;
        });
        h += `<div class="add-btn" onclick="addUser()">+</div>`;
        s.innerHTML = h;
        document.querySelectorAll('.p-unit').forEach(el => {
            el.onmouseenter = () => { if(el.classList.contains('active')) el.querySelector('div[onclick]').style.opacity=1; }
            el.onmouseleave = () => el.querySelector('div[onclick]').style.opacity=0;
        });
    }

    function switchUser(id) { activeId=id; render(); update(); }
    function getUser() { return users.find(x=>x.id===activeId); }

    function update() {
        const u = getUser();
        const s = STATES[u.status];
        document.getElementById('d-name').innerText = u.name;
        document.getElementById('d-status').innerText = s.t;
        document.getElementById('d-status').style.color = s.c;
        document.getElementById('d-count').innerText = cart.length;
        const p = document.getElementById('d-prefs');
        const map = {'a-milk':'ğŸ¥›','a-gluten':'ğŸ','d-diabetic':'ğŸ’‰','k-kosher':'ğŸ“œ','l-vegan':'ğŸŒ±'};
        p.innerHTML = u.filters.length ? u.filters.map(f=>`<span class="pref-pill">${map[f]||''} ${f.split('-')[1]}</span>`).join('') : '<span class="pref-pill">×œ×œ× ××’×‘×œ×•×ª</span>';
    }

    // --- 5. CAMERA & SOUND ---
    const beep = new AudioContext(); 
    function playBeep() {
        const o = beep.createOscillator(); const g = beep.createGain();
        o.connect(g); g.connect(beep.destination);
        o.frequency.value = 800; g.gain.value = 0.1;
        o.start(); setTimeout(() => o.stop(), 100);
    }

    function startScanner() {
        document.getElementById('modal-scan').classList.add('open');
        html5QrcodeScanner = new Html5Qrcode("reader");
        const config = { fps: 10, qrbox: { width: 250, height: 250 }, aspectRatio: 1.0 };
        html5QrcodeScanner.start({ facingMode: "environment" }, config, onScanSuccess, onScanFailure)
        .catch(err => { console.log("Cam Fail"); setTimeout(() => { onScanSuccess("DEMO", null); }, 1500); });
    }

    function stopScanner() {
        if(html5QrcodeScanner) { html5QrcodeScanner.stop().then(() => { html5QrcodeScanner.clear(); }).catch(err => console.log(err)); }
        closeModal('scan');
    }

    function onScanSuccess(decodedText, decodedResult) {
        stopScanner(); playBeep();
        const p = DB[Math.floor(Math.random()*DB.length)];
        calculateGrade(p);
    }
    function onScanFailure(error) {}

    // --- 6. CORE ALGORITHM ---
    function calculateGrade(p) {
        const u = getUser();
        let g = p.g; 
        let alerts = [];

        // 1. Allergies
        if(u.filters.includes('a-gluten') && p.gl) { g='E'; alerts.push({t:'××›×™×œ ×’×œ×•×˜×Ÿ',c:'bad'}); }
        if(u.filters.includes('a-milk') && p.da) { g='E'; alerts.push({t:'××›×™×œ ×—×œ×‘',c:'bad'}); }
        if(u.filters.includes('d-diabetic') && p.sug) { g='E'; alerts.push({t:'×¡×•×›×¨ ×’×‘×•×”',c:'bad'}); }
        if(u.filters.includes('a-nuts') && p.nut) { g='E'; alerts.push({t:'××’×•×–×™×',c:'bad'}); }
        if(u.filters.includes('a-sesame') && p.ses) { g='E'; alerts.push({t:'×©×•××©×•×',c:'bad'}); }
        if(u.filters.includes('a-soy') && p.soy) { g='E'; alerts.push({t:'×¡×•×™×”',c:'bad'}); }
        if(u.filters.includes('a-fish') && p.fish) { g='E'; alerts.push({t:'×“×’×™×',c:'bad'}); }
        if(u.filters.includes('a-eggs') && p.eggs) { g='E'; alerts.push({t:'×‘×™×¦×™×',c:'bad'}); }
        
        // 2. Medical
        if(u.filters.includes('d-salt') && p.salt) { g='D'; alerts.push({t:'× ×ª×¨×Ÿ ×’×‘×•×”',c:'warn'}); }
        if(u.filters.includes('d-heart') && (p.trans || p.palm)) { g='D'; alerts.push({t:'×©×•××Ÿ ×¨×•×•×™',c:'warn'}); }

        // 3. Diet
        if(u.filters.includes('l-vegan') && (p.da || p.fish || p.eggs)) { g='E'; alerts.push({t:'×œ× ×˜×‘×¢×•× ×™',c:'bad'}); }
        if(u.filters.includes('l-keto') && (p.sug || p.gl)) { g='E'; alerts.push({t:'×¤×—××™××•×ª',c:'bad'}); }

        // 4. Bad Stuff
        if(u.filters.includes('x-sugar') && p.sug) { g='E'; alerts.push({t:'×¡×•×›×¨ ×œ×‘×Ÿ',c:'bad'}); }
        if(u.filters.includes('x-proc') && p.proc) { g='E'; alerts.push({t:'××–×•×Ÿ ××¢×•×‘×“',c:'bad'}); }
        if(u.filters.includes('x-caff') && p.caff) { g='D'; alerts.push({t:'×§×¤××™×Ÿ',c:'warn'}); }

        // 5. Ethics
        if(u.filters.includes('e-local') && !p.local) { alerts.push({t:'×œ× ×ª×•×¦×¨×ª ×”××¨×¥',c:'info'}); }

        // 6. Quality
        if(u.filters.includes('q-nored')) { if(p.sug || p.salt || (p.da && p.proc)) { g='E'; alerts.push({t:'××“×‘×§×” ××“×•××”',c:'bad'}); } }
        if(u.filters.includes('q-green') && !p.proc && !p.sug) { alerts.push({t:'×ª×• ×™×¨×•×§',c:'good'}); if(g!=='A') g='B'; }

        // 7. Context
        if(g !== 'E') {
            if(u.status==='stress' && p.sug) { g='D'; alerts.push({t:'×œ× ××•××œ×¥ ×‘×¡×˜×¨×¡',c:'warn'}); }
            if(u.status==='sick' && p.da) { g='D'; alerts.push({t:'××’×‘×™×¨ ×œ×™×—×”',c:'warn'}); }
            if(u.status==='sugar' && p.sug) { g='B'; alerts.push({t:'××¢×œ×” ×¡×•×›×¨',c:'good'}); }
        }

        document.getElementById('r-name').innerText = p.n;
        document.getElementById('r-brand').innerText = p.brand;
        const ge = document.getElementById('r-grade');
        ge.innerText = g;
        let gc = '#fff';
        if(g==='A') gc='var(--grade-a)'; if(g==='B') gc='var(--grade-b)'; if(g==='C') gc='var(--grade-c)'; if(g==='D') gc='var(--grade-d)'; if(g==='E') gc='var(--grade-e)';
        ge.style.background = gc; ge.style.boxShadow = `0 0 50px ${gc}`;

        const al = document.getElementById('res-alert');
        al.innerHTML = alerts.length ? alerts.map(a => {
            let color = a.c==='bad' ? 'var(--grade-e)' : (a.c==='good'?'var(--grade-a)':(a.c==='info'?'#fff':'var(--grade-d)'));
            return `<div class="alert-box" style="border:1px solid ${color}; color:${color};">${a.t}</div>`;
        }).join('') : '<div style="color:#888; margin-bottom:20px;">××•×¦×¨ ×ª×•×× ×œ×¤×¨×•×¤×™×œ</div>';
        
        let tempScan = {n:p.n + ' ' + p.brand, u:u.name};
        document.getElementById('modal-res').classList.add('open');
        
        window.tempScan = tempScan; // Global Ref
    }

    // --- 7. UTILS ---
    function quickAdd() { const v=document.getElementById('q-inp').value; if(v){cart.push({n:v,u:'×‘×™×ª'});save();document.getElementById('q-inp').value='';showToast('× ×•×¡×£ ×œ×‘×™×ª');update();} }
    function quickAddCart() { const v=document.getElementById('c-inp').value; if(v){cart.push({n:v,u:'×‘×™×ª'});save();document.getElementById('c-inp').value='';renderCart();} }
    function addToCart(house) { cart.push({n:window.tempScan.n, u:house?'×‘×™×ª':window.tempScan.u}); save(); closeModal('res'); showToast('× ×•×¡×£ ×œ×¡×œ'); update(); }
    function openCart() { renderCart(); document.getElementById('modal-cart').classList.add('open'); }
    function renderCart() {
        const d = document.getElementById('cart-content');
        d.innerHTML = cart.length ? cart.map((i,x) => `
            <div class="cart-row">
                <div><span class="tag ${i.u==='×‘×™×ª'?'t-home':'t-me'}">${i.u}</span> ${i.n}</div>
                <div onclick="remCart(${x})" style="color:var(--grade-e); cursor:pointer;">âœ•</div>
            </div>`).join('') : '<div style="text-align:center; opacity:0.5; margin-top:20px;">×”×¡×œ ×¨×™×§</div>';
    }
    function remCart(i) { cart.splice(i,1); save(); renderCart(); update(); }

    function addUser() { const id=Date.now(); users.push({id,name:'×—×“×©',status:'normal',filters:[],pList:[],img:null}); activeId=id; openEdit(id); }
    function openEdit(id) { editingId=id; const u=users.find(x=>x.id===id); document.getElementById('edit-name').value=u.name; tempImg=u.img; 
        const prev=document.getElementById('preview-img'); const icon=document.getElementById('cam-icon');
        if(tempImg){prev.src=tempImg;prev.style.display='block';icon.style.display='none';}else{prev.style.display='none';icon.style.display='block';}
        document.querySelectorAll('.chip').forEach(c=>c.checked=false);
        u.filters.forEach(f=>{if(document.getElementById(f))document.getElementById(f).checked=true;});
        renderPList(); document.getElementById('modal-edit').classList.add('open'); }
    
    function handleImg(i) { if(i.files[0]){const r=new FileReader(); r.onload=e=>{tempImg=e.target.result; document.getElementById('preview-img').src=tempImg; document.getElementById('preview-img').style.display='block'; document.getElementById('cam-icon').style.display='none';}; r.readAsDataURL(i.files[0]);}}
    function clearSec(id) { document.getElementById(id).querySelectorAll('input').forEach(i=>i.checked=false); showToast('× ×•×§×”'); }
    function addPersonal() { const v=prompt('×”×•×¡×£ ××•×¦×¨:'); if(v){const u=users.find(x=>x.id===editingId); u.pList.push(v); cart.push({n:v,u:u.name}); save(); renderPList();} }
    function renderPList() { const u=users.find(x=>x.id===editingId); document.getElementById('p-list-con').innerHTML=u.pList.length?u.pList.map(i=>`<div>âœ“ ${i}</div>`).join(''):'××™×Ÿ ×¤×¨×™×˜×™×'; }
    function saveProfile() { const u=users.find(x=>x.id===editingId); u.name=document.getElementById('edit-name').value||'×œ×œ× ×©×'; u.img=tempImg; u.filters=[]; document.querySelectorAll('.chip:checked').forEach(c=>u.filters.push(c.id)); save(); closeModal('edit'); render(); update(); }
    function deleteProfile() { if(users.length<=1)return alert('×—×•×‘×” ×œ×”×©××™×¨ ×¤×¨×•×¤×™×œ ××—×“'); if(confirm('×œ××—×•×§?')){users=users.filter(x=>x.id!==editingId); activeId=users[0].id; save(); closeModal('edit'); render(); update();} }
    function openRing() { document.getElementById('modal-ring').classList.add('open'); }
    function setRing(s) { getUser().status=s; save(); render(); update(); closeModal('ring'); }
    function save() { localStorage.setItem('vTitan_ultra_users', JSON.stringify(users)); localStorage.setItem('vTitan_ultra_cart', JSON.stringify(cart)); }
    function closeModal(id) { document.getElementById('modal-'+id).classList.remove('open'); }
    function tog(el) { el.nextElementSibling.classList.toggle('open'); }
    function showToast(t) { const el=document.getElementById('toast'); el.innerText=t; el.classList.add('show'); setTimeout(()=>el.classList.remove('show'),2000); }

</script>
</body>
</html>
